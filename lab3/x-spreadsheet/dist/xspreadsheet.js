!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=178)}({177:function(t,e,n){},178:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function l(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}n.r(e),n.d(e,"spreadsheet",(function(){return Rb}));var c=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";a(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.data={}}return e=t,(n=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var n=i(t.split(".")),r=n[0],a=o(n).slice(1),u=r;return"mousewheel"===u&&/Firefox/i.test(window.navigator.userAgent)&&(u="DOMMouseScroll"),this.el.addEventListener(u,(function(t){e(t);for(var n=0;n<a.length;n+=1){var r=a[n];if("left"===r&&0!==t.button)return;if("right"===r&&2!==t.button)return;"stop"===r&&t.stopPropagation()}})),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach((function(n){e.css(n,"".concat(t[n],"px"))})),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach((function(e){return t.child(e)})),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach((function(e){n.el.setAttribute(e,t[e])}))}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){return t.el.style.removeProperty(e)})),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach((function(e){n.el.style[e]=t[e]})),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&u(e.prototype,n),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}(),s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new c(t,e)};n(54);function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var y=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function p(t){for(var e="",n=t;n>=y.length;)n/=y.length,n-=1,e+=y[parseInt(n,10)%y.length];return e+=y[t%y.length]}function v(t){for(var e=0,n=0;n!==t.length;++n)e=26*e+t.charCodeAt(n)-64;return e-1}function d(t){for(var e="",n="",r=0;r<t.length;r+=1)t.charAt(r)>="0"&&t.charAt(r)<="9"?n+=t.charAt(r):e+=t.charAt(r);return[v(e),parseInt(n,10)-1]}function b(t,e){return"".concat(p(t)).concat(e+1)}function m(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===n)return t;var i=d(t),o=f(i,2),a=o[0],u=o[1];return r(a,u)?b(a+e,u+n):t}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return S(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function O(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,j(r.key),r)}}function j(t){var e=function(t,e){if("object"!=g(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==g(e)?e:e+""}var _=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;O(this,t),this.sri=e,this.sci=n,this.eri=r,this.eci=i,this.w=o,this.h=a}return e=t,r=[{key:"valueOf",value:function(e){var n=e.split(":"),r=w(d(n[0]),2),i=r[0],o=r[1],a=o,u=i;if(n.length>1){var l=w(d(n[1]),2);u=l[0],a=l[1]}return new t(o,i,a,u)}}],(n=[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(1===r.length){var o=d(r[0]),a=w(o,2);e=a[0],t=a[1]}else 2===r.length&&(t=r[0],e=r[1]);var u=this.sri,l=this.sci,c=this.eri,s=this.eci;return u<=t&&t<=c&&l<=e&&e<=s}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,i=this.eri,o=this.eci,a=n;a<=i;a+=1)if(e(a))for(var u=r;u<=o;u+=1)t(a,u)}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,r=this.sci,i=this.eri,o=this.eci;return new t(e.sri<n?e.sri:n,e.sci<r?e.sci:r,e.eri>i?e.eri:i,e.eci>o?e.eci:o)}},{key:"difference",value:function(e){var n=[],r=function(e,r,i,o){n.push(new t(e,r,i,o))},i=this.sri,o=this.sci,a=this.eri,u=this.eci,l=e.sri-i,c=e.sci-o,s=a-e.eri,f=u-e.eci;return l>0?(r(i,o,e.sri-1,u),s>0?(r(e.eri+1,o,a,u),c>0&&r(e.sri,o,e.eri,e.sci-1),f>0&&r(e.sri,e.eci+1,e.eri,u)):(c>0&&r(e.sri,o,a,e.sci-1),f>0&&r(e.sri,e.eci+1,a,u))):s>0&&(r(e.eri+1,o,a,u),c>0&&r(i,o,e.eri,e.sci-1),f>0&&r(i,e.eci+1,e.eri,u)),c>0?(r(i,o,a,e.sci-1),f>0?(r(i,e.eri+1,a,u),l>0&&r(i,e.sci,e.sri-1,e.eci),s>0&&r(e.sri+1,e.sci,a,e.eci)):(l>0&&r(i,e.sci,e.sri-1,u),s>0&&r(e.sri+1,e.sci,a,u))):f>0&&(r(a,e.eci+1,a,u),l>0&&r(i,o,e.sri-1,e.eci),s>0&&r(e.eri+1,o,a,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,r=this.eci,i=b(e,t);return this.multiple()&&(i="".concat(i,":").concat(b(r,n))),i}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&k(e.prototype,n),r&&k(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,E(r.key),r)}}function E(t){var e=function(t,e){if("object"!=x(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==x(e)?e:e+""}var A=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new _(0,0,0,0),this.ri=0,this.ci=0},(e=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&P(t.prototype,e),n&&P(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,R(r.key),r)}}function M(t,e,n){return e&&C(t.prototype,e),n&&C(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function R(t){var e=function(t,e){if("object"!=T(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==T(e)?e:e+""}var N=M((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0}));function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function D(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$(r.key),r)}}function $(t){var e=function(t,e){if("object"!=I(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==I(e)?e:e+""}var z=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]},(e=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canUndo()&&(r.push(JSON.stringify(t)),e(JSON.parse(n.pop())))}},{key:"redo",value:function(t,e){var n=this.undoItems,r=this.redoItems;this.canRedo()&&(n.push(JSON.stringify(t)),e(JSON.parse(r.pop())))}}])&&D(t.prototype,e),n&&D(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,F(r.key),r)}}function F(t){var e=function(t,e){if("object"!=B(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==B(e)?e:e+""}var q=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear"},(e=[{key:"copy",value:function(t){return this.range=t,this.state="copy",this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}}])&&H(t.prototype,e),n&&H(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function V(t){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,X(r.key),r)}}function L(t,e,n){return e&&U(t.prototype,e),n&&U(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function X(t){var e=function(t,e){if("object"!=V(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=V(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==V(e)?e:e+""}var Y=function(){return L((function t(e,n,r){W(this,t),this.ci=e,this.operator=n,this.value=r}),[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,n=this.value;return"all"===e||"in"===e&&n.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}])}(),Z=function(){return L((function t(e,n){W(this,t),this.ci=e,this.order=n}),[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}])}(),K=function(){return L((function t(){W(this,t),this.ref=null,this.filters=[],this.sort=null}),[{key:"setData",value:function(t){var e=t.ref,n=t.filters,r=t.sort;null!=e&&(this.ref=e,this.filters=n.map((function(t){return new Y(t.ci,t.operator,t.value)})),r&&(this.sort=new Z(r.ci,r.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,n=this.sort;return{ref:t,filters:e.map((function(t){return t.getData()})),sort:n}}return{}}},{key:"addFilter",value:function(t,e,n){var r=this.getFilter(t);null==r?this.filters.push(new Y(t,e,n)):r.set(e,n)}},{key:"setSort",value:function(t,e){this.sort=e?new Z(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,n=0;n<e.length;n+=1)if(e[n].ci===t)return e[n];return null}},{key:"filteredRows",value:function(t){var e=new Set,n=new Set;if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=this.filters,u=i+1;u<=o;u+=1)for(var l=0;l<a.length;l+=1){var c=a[l],s=t(u,c.ci),f=s?s.text:"";if(!c.includes(f)){e.add(u);break}n.add(u)}return{rset:e,fset:n}}},{key:"items",value:function(t,e){var n={};if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=i+1;a<=o;a+=1){var u=e(a,t);if(null===u||/^\s*$/.test(u.text))n[""]=(n[""]||0)+1;else{var l=u.text,c=(n[l]||0)+1;n[l]=c}}return n}},{key:"range",value:function(){return _.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}])}();function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function G(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tt(r.key),r)}}function tt(t){var e=function(t,e){if("object"!=J(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=J(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==J(e)?e:e+""}var et=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];G(this,t),this._=e}return e=t,(n=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter((function(e){return!e.within(t)}))}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter((function(t){return t.intersects(e)})))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1)if(this._[e].intersects(t))return!0;return!1}},{key:"union",value:function(t){var e=t;return this._.forEach((function(t){t.intersects(e)&&(e=t.union(e))})),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,n,r){this._.forEach((function(i){var o=i.sri,a=i.sci,u=i.eri,l=i.eci,c=i;"row"===t?o>=e?(c.sri+=n,c.eri+=n):o<e&&e<=u&&(c.eri+=n,r(o,a,n,0)):"column"===t&&(a>=e?(c.sci+=n,c.eci+=n):a<e&&e<=l&&(c.eci+=n,r(o,a,0,n)))}))}},{key:"move",value:function(t,e,n){this._.forEach((function(r){var i=r;i.within(t)&&(i.eri+=e,i.sri+=e,i.sci+=n,i.eci+=n)}))}},{key:"setData",value:function(t){return this._=t.map((function(t){return _.valueOf(t)})),this}},{key:"getData",value:function(){return this._.map((function(t){return t.toString()}))}}])&&Q(e.prototype,n),r&&Q(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();var nt=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.forEach((function(e){Object.keys(e).forEach((function(n){var r=e[n];"string"==typeof r||"number"==typeof r||"boolean"==typeof r?t[n]=r:"function"!=typeof r&&!Array.isArray(r)&&r instanceof Object?(t[n]=t[n]||{},nt(t[n],r)):t[n]=r}))})),t};function rt(t){for(var e="".concat(t),n=0,r=!1,i=0;i<e.length;i+=1)!0===r&&(n+=1),"."===e.charAt(i)&&(r=!0);return n}function it(t,e,n){if(Number.isNaN(e)||Number.isNaN(n))return e+t+n;var r=rt(e),i=rt(n),o=Number(e),a=Number(n),u=0;if("-"===t)u=o-a;else if("+"===t)u=o+a;else if("*"===t)u=o*a;else if("/"===t)return rt(u=o/a)>5?u.toFixed(2):u;return u.toFixed(Math.max(r,i))}var ot={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return nt.apply(void 0,[{}].concat(e))},equals:function t(e,n){var r=Object.keys(e);if(r.length!==Object.keys(n).length)return!1;for(var i=0;i<r.length;i+=1){var o=r[i],a=e[o],u=n[o];if(void 0===u)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==u)return!1}else if(Array.isArray(a)){if(a.length!==u.length)return!1;for(var l=0;l<a.length;l+=1)if(!t(a[l],u[l]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,u))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,r=0;return Object.keys(t).forEach((function(i){n+=e(t[i],i),r+=1})),[n,r]},rangeEach:function(t,e,n){for(var r=t;r<e;r+=1)n(r)},rangeSum:function(t,e,n){for(var r=0,i=t;i<e;i+=1)r+=n(i);return r},rangeReduceIf:function(t,e,n,r,i,o){for(var a=n,u=r,l=t;l<e&&!(a>i);l+=1)a+=u=o(l);return[l,a-u,u]},deleteProperty:function(t,e){var n=t["".concat(e)];return delete t["".concat(e)],n},numberCalc:it};function at(t){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ut(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return lt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ct(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,st(r.key),r)}}function st(t){var e=function(t,e){if("object"!=at(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=at(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==at(e)?e:e+""}var ft=function(){return t=function t(e){var n=e.len,r=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.height=r},(e=[{key:"getHeight",value:function(t){if(this.isHide(t))return 0;var e=this.get(t);return e&&e.height?e.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e,n){var r=this;return ot.rangeSum(t,e,(function(t){return n&&n.has(t)?0:r.getHeight(t)}))}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var n=this.get(t);return void 0!==n&&void 0!==n.cells&&void 0!==n.cells[e]?n.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var n=this.getCell(t,e);return n&&n.merge?n.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var n=this.getOrNew(t);return n.cells[e]=n.cells[e]||{},n.cells[e]}},{key:"setCell",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=this.getOrNew(t);"all"===r?i.cells[e]=n:"text"===r?(i.cells[e]=i.cells[e]||{},i.cells[e].text=n.text):"format"===r&&(i.cells[e]=i.cells[e]||{},i.cells[e].style=n.style,n.merge&&(i.cells[e].merge=n.merge))}},{key:"setCellText",value:function(t,e,n){var r=this.getCellOrNew(t,e);!1!==r.editable&&(r.text=n)}},{key:"copyPaste",value:function(t,e,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a=t.sri,u=t.sci,l=t.eri,c=t.eci,s=e.sri,f=e.sci,h=e.eri,y=e.eci,p=t.size(),v=ut(p,2),d=v[0],b=v[1],g=e.size(),w=ut(g,2),S=w[0],O=w[1],k=!0,j=0;(h<a||y<u)&&(k=!1,j=h<a?S:O);for(var _=a;_<=l;_+=1)if(this._[_])for(var x=u;x<=c;x+=1)if(this._[_].cells&&this._[_].cells[x])for(var P=s;P<=h;P+=d)for(var E=function(){var t=P+(_-a),e=A+(x-u),p=ot.cloneDeep(r._[_].cells[x]);if(i&&p&&p.text&&p.text.length>0){var v=p.text,g=A-f+(P-s)+2;if(k||(g-=j+1),"="===v[0])p.text=v.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){var e=0,n=0;return a===s?e=g-1:n=g-1,/^\d+$/.test(t)?t:m(t,e,n)}));else if(d<=1&&b>1&&(s>l||h<a)||b<=1&&d>1&&(f>c||y<u)||d<=1&&b<=1){var w=/[\\.\d]+$/.exec(v);if(null!==w){var S=Number(w[0])+g-1;p.text=v.substring(0,w.index)+S}}}r.setCell(t,e,p,n),o(t,e,p)},A=f;A<=y;A+=b)E()}},{key:"cutPaste",value:function(t,e){var n=this,r={};this.each((function(i){n.eachCells(i,(function(o){var a=parseInt(i,10),u=parseInt(o,10);t.includes(i,o)&&(a=e.sri+(a-t.sri),u=e.sci+(u-t.sci)),r[a]=r[a]||{cells:{}},r[a].cells[u]=n._[i].cells[o]}))})),this._=r}},{key:"paste",value:function(t,e){var n=this;if(!(t.length<=0)){var r=e.sri,i=e.sci;t.forEach((function(t,e){var o=r+e;t.forEach((function(t,e){var r=i+e;n.setCellText(o,r,t)}))}))}}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r={};this.each((function(i,o){var a=parseInt(i,10);a>=t&&(a+=n,e.eachCells(i,(function(e,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return m(e,0,n,(function(e,n){return n>=t}))})))}))),r[a]=o})),this._=r,this.len+=n}},{key:"delete",value:function(t,e){var n=this,r=e-t+1,i={};this.each((function(o,a){var u=parseInt(o,10);u<t?i[u]=a:o>e&&(i[u-r]=a,n.eachCells(o,(function(t,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return m(t,0,-r,(function(t,n){return n>e}))})))})))})),this._=i,this.len-=r}},{key:"insertColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each((function(r,i){var o={};e.eachCells(r,(function(e,r){var i=parseInt(e,10);i>=t&&(i+=n,r.text&&"="===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(e){return m(e,n,0,(function(e){return e>=t}))})))),o[i]=r})),i.cells=o}))}},{key:"deleteColumn",value:function(t,e){var n=this,r=e-t+1;this.each((function(i,o){var a={};n.eachCells(i,(function(n,i){var o=parseInt(n,10);o<t?a[o]=i:o>e&&(a[o-r]=i,i.text&&"="===i.text[0]&&(i.text=i.text.replace(/[a-zA-Z]{1,3}\d+/g,(function(t){return m(t,-r,0,(function(t){return t>e}))}))))})),o.cells=a}))}},{key:"deleteCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each((function(t,r){e.deleteCell(t,r,n)}))}},{key:"deleteCell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=this.get(t);if(null!==r){var i=this.getCell(t,e);null!==i&&!1!==i.editable&&("all"===n?delete r.cells[e]:"text"===n?(i.text&&delete i.text,i.value&&delete i.value):"format"===n?(void 0!==i.style&&delete i.style,i.merge&&delete i.merge):"merge"===n&&i.merge&&delete i.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],n=this._[e];if(n){var r=n.cells,i=Object.keys(r),o=i[i.length-1];return[parseInt(e,10),parseInt(o,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach((function(e){var n=ut(e,2),r=n[0],i=n[1];t(r,i)}))}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach((function(t){var n=ut(t,2),r=n[0],i=n[1];e(r,i)}))}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}}])&&ct(t.prototype,e),n&&ct(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pt(r.key),r)}}function pt(t){var e=function(t,e){if("object"!=ht(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ht(e)?e:e+""}var vt=function(){return t=function t(e){var n=e.len,r=e.width,i=e.indexWidth,o=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.width=r,this.indexWidth=i,this.minWidth=o},(e=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var n=this;return ot.rangeSum(t,e,(function(t){return n.getWidth(t)}))}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&yt(t.prototype,e),n&&yt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function dt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return bt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var mt=["en"],gt={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Colun",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not betwwen",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}}}};function wt(t,e){if(e){var n,r=dt(mt);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!e[i])break;for(var o=e[i],a=t.match(/(?:\\.|[^.])+/g),u=0;u<a.length;u+=1){var l=o[a[u]];if(!l)break;if(u===a.length-1)return l;o=l}}}catch(t){r.e(t)}finally{r.f()}}}function St(t){var e=wt(t,gt);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=wt(t,window.x_spreadsheet.$messages)),e||""}function Ot(t){return function(){return St(t)}}function kt(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n?mt=[t]:mt.unshift(t),e&&(gt[t]=e)}function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return xt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Et(r.key),r)}}function Et(t){var e=function(t,e){if("object"!=jt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=jt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==jt(e)?e:e+""}var At={phone:/^[1-9]\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function Tt(t,e){var n="";if(!t){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];n=St.apply(void 0,["validation.".concat(e)].concat(i))}return[t,n]}var Ct=function(){return t=function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=n,this.value=r,this.type=e,this.operator=i,this.message=""},(e=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?ot.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,n=this.operator,r=this.value,i=this.type;if(e&&/^\s*$/.test(t))return Tt(!1,"required");if(/^\s*$/.test(t))return[!0];if(At[i]&&!At[i].test(t))return Tt(!1,"notMatch");if("list"===i)return Tt(this.values().includes(t),"notIn");if(n){var o=this.parseValue(t);if("be"===n){var a=_t(r,2),u=a[0],l=a[1];return Tt(o>=this.parseValue(u)&&o<=this.parseValue(l),"between",u,l)}if("nbe"===n){var c=_t(r,2),s=c[0],f=c[1];return Tt(o<this.parseValue(s)||o>this.parseValue(f),"notBetween",s,f)}if("eq"===n)return Tt(o===this.parseValue(r),"equal",r);if("neq"===n)return Tt(o!==this.parseValue(r),"notEqual",r);if("lt"===n)return Tt(o<this.parseValue(r),"lessThan",r);if("lte"===n)return Tt(o<=this.parseValue(r),"lessThanEqual",r);if("gt"===n)return Tt(o>this.parseValue(r),"greaterThan",r);if("gte"===n)return Tt(o>=this.parseValue(r),"greaterThanEqual",r)}return[!0]}}])&&Pt(t.prototype,e),n&&Pt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function Mt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Rt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Nt(t){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function It(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zt(r.key),r)}}function $t(t,e,n){return e&&Dt(t.prototype,e),n&&Dt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zt(t){var e=function(t,e){if("object"!=Nt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Nt(e)?e:e+""}var Bt=function(){function t(e,n,r){It(this,t),this.refs=n,this.mode=e,this.validator=r}return $t(t,[{key:"includes",value:function(t,e){for(var n=this.refs,r=0;r<n.length;r+=1){if(_.valueOf(n[r]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(_.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach((function(n){var r=_.valueOf(n);r.intersects(t)?r.difference(t).forEach((function(t){return e.push(t.toString())})):e.push(n)})),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,n=this.validator;return{refs:t,mode:e,type:n.type,required:n.required,operator:n.operator,value:n.value}}}],[{key:"valueOf",value:function(e){var n=e.refs,r=e.mode,i=e.type,o=e.required,a=e.operator,u=e.value;return new t(r,n,new Ct(i,o,u,a))}}])}(),Ht=function(){return $t((function t(){It(this,t),this._=[],this.errors=new Map}),[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,n){var r=this.get(t,e),i="".concat(t,"_").concat(e),o=this.errors;if(null!==r){var a=Mt(r.validator.validate(n),2),u=a[0],l=a[1];u?o.delete(i):o.set(i,l)}else o.delete(i);return!0}},{key:"add",value:function(t,e,n){var r=n.type,i=n.required,o=n.value,a=n.operator,u=new Ct(r,i,o,a),l=this.getByValidator(u);null!==l?l.addRef(e):this._.push(new Bt(t,[e],u))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var n=this._[e];if(n.validator.equals(t))return n}return null}},{key:"get",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"remove",value:function(t){this.each((function(e){e.remove(t)}))}},{key:"each",value:function(t){this._.forEach((function(e){return t(e)}))}},{key:"getData",value:function(){return this._.filter((function(t){return t.refs.length>0})).map((function(t){return t.getData()}))}},{key:"setData",value:function(t){this._=t.map((function(t){return Bt.valueOf(t)}))}}])}();function Ft(t){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qt(t){return function(t){if(Array.isArray(t))return Xt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Lt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wt(r.key),r)}}function Wt(t){var e=function(t,e){if("object"!=Ft(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ft(e)?e:e+""}function Ut(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||Lt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(t,e){if(t){if("string"==typeof t)return Xt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xt(t,e):void 0}}function Xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Yt={mode:"edit",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:"#ffffff",align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function Zt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.merges,i=e.clone(),o=t.size(),a=Ut(o,2),u=a[0],l=a[1],c=e.size(),s=Ut(c,2),f=s[0],h=s[1];return u>f&&(i.eri=e.sri+u-1),l>h&&(i.eci=e.sci+l-1),!r.intersects(i)||(n(St("error.pasteForMergedCell")),!1)}function Kt(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.rows,o=this.merges;"all"!==n&&"format"!==n||(i.deleteCells(e,n),o.deleteWithin(e)),i.copyPaste(t,e,n,r,(function(t,e,n){if(n&&n.merge){var r=Ut(n.merge,2),i=r[0],a=r[1];if(i<=0&&a<=0)return;o.add(new _(t,e,t+i,e+a))}}))}function Jt(t,e){var n=this.clipboard,r=this.rows,i=this.merges;r.cutPaste(t,e),i.move(t,e.sri-t.sri,e.sci-t.sci),n.clear()}function Gt(t,e,n){var r=this.styles,i=this.rows.getCellOrNew(t,e),o={};void 0!==i.style&&(o=ot.cloneDeep(r[i.style])),o=ot.merge(o,{border:n}),i.style=this.addStyle(o)}function Qt(t){var e=this,n=t.mode,r=t.style,i=t.color,o=this.styles,a=this.selector,u=this.rows,l=a.range,c=l.sri,s=l.sci,f=l.eri,h=l.eci,y=!this.isSingleSelected();if(y||"inside"!==n&&"horizontal"!==n&&"vertical"!==n)if("outside"!==n||y){if("none"===n)a.range.each((function(t,n){var r=u.getCell(t,n);if(r&&void 0!==r.style){var i=ot.cloneDeep(o[r.style]);delete i.border,r.style=e.addStyle(i)}}));else if("all"===n||"inside"===n||"outside"===n||"horizontal"===n||"vertical"===n)for(var p=[],v=c;v<=f;v+=1)for(var d=s;d<=h;d+=1){for(var b=[],m=0;m<p.length;m+=1){var g=Ut(p[m],4),w=g[0],S=g[1],O=g[2],k=g[3];if(v===w+O+1&&b.push(m),w<=v&&v<=w+O&&d===S){d+=k+1;break}}if(b.forEach((function(t){return p.splice(t,1)})),d>h)break;var j=u.getCell(v,d),_=0,x=0;if(j&&j.merge){var P=Ut(j.merge,2);_=P[0],x=P[1],p.push([v,d,_,x])}var E=_>0&&v+_===f,A=x>0&&d+x===h,T={};"all"===n?T={bottom:[r,i],top:[r,i],left:[r,i],right:[r,i]}:"inside"===n?(!A&&d<h&&(T.right=[r,i]),!E&&v<f&&(T.bottom=[r,i])):"horizontal"===n?!E&&v<f&&(T.bottom=[r,i]):"vertical"===n?!A&&d<h&&(T.right=[r,i]):"outside"===n&&y&&(c===v&&(T.top=[r,i]),(E||f===v)&&(T.bottom=[r,i]),s===d&&(T.left=[r,i]),(A||h===d)&&(T.right=[r,i])),Object.keys(T).length>0&&Gt.call(this,v,d,T),d+=x}else if("top"===n||"bottom"===n)for(var C=s;C<=h;C+=1)"top"===n&&(Gt.call(this,c,C,{top:[r,i]}),C+=u.getCellMerge(c,C)[1]),"bottom"===n&&(Gt.call(this,f,C,{bottom:[r,i]}),C+=u.getCellMerge(f,C)[1]);else if("left"===n||"right"===n)for(var M=c;M<=f;M+=1)"left"===n&&(Gt.call(this,M,s,{left:[r,i]}),M+=u.getCellMerge(M,s)[0]),"right"===n&&(Gt.call(this,M,h,{right:[r,i]}),M+=u.getCellMerge(M,h)[0])}else Gt.call(this,c,s,{top:[r,i],bottom:[r,i],left:[r,i],right:[r,i]})}function te(t,e){var n=this.rows,r=this.freezeTotalHeight(),i=n.height;r+n.height<t&&(i-=e);for(var o=this.exceptRowSet,a=0,u=i,l=n.height;a<n.len&&!(u>t);a+=1)o.has(a)||(u+=l=n.getHeight(a));return(u-=l)<=0?{ri:-1,top:0,height:l}:{ri:a-1,top:u,height:l}}function ee(t,e){var n=this.cols,r=this.freezeTotalWidth(),i=n.indexWidth;r+n.indexWidth<t&&(i-=e);var o=Ut(ot.rangeReduceIf(0,n.len,i,n.indexWidth,t,(function(t){return n.getWidth(t)})),3),a=o[0],u=o[1],l=o[2];return u<=0?{ci:-1,left:0,width:n.indexWidth}:{ci:a-1,left:u,width:l}}var ne=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=ot.merge(Yt,n||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new et,this.rows=new ft(this.settings.row),this.cols=new vt(this.settings.col),this.validations=new Ht,this.hyperlinks={},this.comments={},this.selector=new A,this.scroll=new N,this.history=new z,this.clipboard=new q,this.autoFilter=new K,this.change=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map},(e=[{key:"addValidation",value:function(t,e,n){var r=this;this.changeData((function(){r.validations.add(t,e,n)}))}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData((function(){t.validations.remove(e)}))}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=this.validations.get(e,n);return r?r.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=t.range,i=this.validations.get(e,n),o={ref:r.toString()};return null!==i&&(o.mode=i.mode,o.validator=i.validator),o}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(this.getData(),(function(e){t.setData(e)}))}},{key:"redo",value:function(){var t=this;this.history.redo(this.getData(),(function(e){t.setData(e)}))}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range)}},{key:"copyToSystemClipboard",value:function(t){for(var e=[],n=this.selector.range,r=n.sri,i=n.eri,o=n.sci,a=n.eci,u=r;u<=i;u+=1){for(var l=[],c=o;c<=a;c+=1){var s=this.getCell(u,c);l.push(s&&s.text||"")}e.push(l)}e=e.map((function(t){return t.join("\t")})).join("\n"),t&&(t.clipboardData.clearData(),t.clipboardData.setData("text/plain",e),t.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(e).then((function(){}),(function(t){console.log("text copy to the system clipboard error  ",e,t)}))}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.clipboard,i=this.selector;return!r.isClear()&&!!Zt.call(this,r.range,i.range,n)&&(this.changeData((function(){r.isCopy()?Kt.call(t,r.range,i.range,e):r.isCut()&&Jt.call(t,r.range,i.range)})),!0)}},{key:"pasteFromSystemClipboard",value:function(t,e){var n=this,r=this.selector;navigator.clipboard.readText().then((function(i){var o=n.parseClipboardContent(i),a=r.ri;o.forEach((function(t){var e=r.ci;t.forEach((function(t){n.setCellText(a,e,t,"input"),e+=1})),a+=1})),t(),e(n.rows.getData())}))}},{key:"parseClipboardContent",value:function(t){var e=[],n=t.split("\n"),r=0;return n.forEach((function(t){e[r]=t.split("\t"),r+=1})),e}},{key:"pasteFromText",value:function(t){var e=[];if((e=/\r\n/.test(t)?t.split("\r\n").map((function(t){return t.replace(/"/g,"").split("\t")})):t.split("\n").map((function(t){return t.replace(/"/g,"").split("\t")}))).length){var n=this.rows,r=this.selector;this.changeData((function(){n.paste(e,r.range)}))}}},{key:"autofill",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!Zt.call(this,i,t,r)&&(this.changeData((function(){Kt.call(n,i,t,e,!0)})),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges,a=n.range,u=a.sri,l=a.sci,c=a.eri,s=a.eci,f=n.ri,h=n.ci,y=t,p=e;return t<0&&(y=r.len-1),e<0&&(p=i.len-1),y>f?(u=f,c=y):(u=y,c=f),p>h?(l=h,s=p):(l=p,s=h),n.range=o.union(new _(u,l,c,s)),n.range=o.union(n.range),n.range}},{key:"calSelectedRangeByStart",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges.getFirstIncludes(t,e);return null===o&&(o=new _(t,e,t,e),-1===t&&(o.sri=0,o.eri=r.len-1),-1===e&&(o.sci=0,o.eci=i.len-1)),n.range=o,o}},{key:"setSelectedCellAttr",value:function(t,e){var n=this;this.changeData((function(){var r=n.selector,i=n.styles,o=n.rows;if("merge"===t)e?n.merge():n.unmerge();else if("border"===t)Qt.call(n,e);else if("formula"===t){var a=r.ri,u=r.ci,l=r.range;if(r.multiple()){var c=Ut(r.size(),2),s=c[0],f=c[1],h=l.sri,y=l.sci,p=l.eri,v=l.eci;if(s>1)for(var d=y;d<=v;d+=1)o.getCellOrNew(p+1,d).text="=".concat(e,"(").concat(b(d,h),":").concat(b(d,p),")");else f>1&&(o.getCellOrNew(a,v+1).text="=".concat(e,"(").concat(b(y,a),":").concat(b(v,a),")"))}else o.getCellOrNew(a,u).text="=".concat(e,"()")}else r.range.each((function(r,a){var u=o.getCellOrNew(r,a),l={};if(void 0!==u.style&&(l=ot.cloneDeep(i[u.style])),"format"===t)l.format=e,u.style=n.addStyle(l);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var c={};c[t.split("-")[1]]=e,l.font=Object.assign(l.font||{},c),u.style=n.addStyle(l)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t?(l[t]=e,u.style=n.addStyle(l)):u[t]=e}))}))}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",n=this.autoFilter,r=this.selector,i=this.rows,o=r.ri,a=r.ci,u=o;this.unsortedRowMap.has(o)&&(u=this.unsortedRowMap.get(o));var l=i.getCell(u,a),c=l?l.text:"";if(this.setCellText(u,a,t,e),n.active()){var s=n.getFilter(a);if(s){var f=s.value.findIndex((function(t){return t===c}));f>=0&&s.value.splice(f,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,n)}},{key:"xyInSelectedRect",value:function(t,e){var n=this.getSelectedRect(),r=n.left,i=n.top,o=n.width,a=n.height,u=t-this.cols.indexWidth,l=e-this.rows.height;return u>r&&u<r+o&&l>i&&l<i+a}},{key:"getSelectedRect",value:function(){return this.getRect(this.selector.range)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,n=this.rows,r=this.cols,i=this.exceptRowSet,o=t.sri,a=t.sci,u=t.eri,l=t.eci;if(o<0&&a<0)return{left:0,l:0,top:0,t:0,scroll:e};var c=r.sumWidth(0,a),s=n.sumHeight(0,o,i),f=n.sumHeight(o,u+1,i),h=r.sumWidth(a,l+1),y=c-e.x,p=s-e.y,v=this.freezeTotalHeight(),d=this.freezeTotalWidth();return d>0&&d>c&&(y=c),v>0&&v>s&&(p=s),{l:c,t:s,left:y,top:p,height:f,width:h,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var n=this.scroll,r=this.merges,i=this.rows,o=this.cols,a=te.call(this,e,n.y),u=a.ri,l=a.top,c=a.height,s=ee.call(this,t,n.x),f=s.ci,h=s.left,y=s.width;if(-1===f&&(y=o.totalWidth()),-1===u&&(c=i.totalHeight()),u>=0||f>=0){var p=r.getFirstIncludes(u,f);if(p){u=p.sri,f=p.sci;var v=this.cellRect(u,f);h=v.left,l=v.top,y=v.width,c=v.height}}return{ri:u,ci:f,left:h,top:l,width:y,height:c}}},{key:"isSingleSelected",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=Ut(o.merge,2),u=a[0],l=a[1];if(e+u===r&&n+l===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=Ut(o.merge,2),u=a[0],l=a[1];if(e+u===r&&n+l===i)return!0}return!1}},{key:"merge",value:function(){var t=this,e=this.selector,n=this.rows;if(!this.isSingleSelected()){var r=Ut(e.size(),2),i=r[0],o=r[1];if(i>1||o>1){var a=e.range,u=a.sri,l=a.sci;this.changeData((function(){var r=n.getCellOrNew(u,l);r.merge=[i-1,o-1],t.merges.add(e.range),t.rows.deleteCells(e.range),t.rows.setCell(u,l,r)}))}}}},{key:"unmerge",value:function(){var t=this,e=this.selector;if(this.isSingleSelected()){var n=e.range,r=n.sri,i=n.sci;this.changeData((function(){t.rows.deleteCell(r,i,"merge"),t.merges.deleteWithin(e.range)}))}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,n=this.selector;this.changeData((function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=n.range.toString()}))}},{key:"setAutoFilter",value:function(t,e,n,r){var i=this.autoFilter;i.addFilter(t,n,r),i.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.autoFilter,n=this.rows;if(e.active()){var r=e.sort,i=e.filteredRows((function(t,e){return n.getCell(t,e)})),o=i.rset,a=i.fset,u=Array.from(a),l=Array.from(a);r&&u.sort((function(t,e){return"asc"===r.order?t-e:"desc"===r.order?e-t:0})),this.exceptRowSet=o,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,u.forEach((function(e,n){t.sortedRowMap.set(l[n],e),t.unsortedRowMap.set(e,l[n])}))}}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=this.selector;this.changeData((function(){t.rows.deleteCells(n.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(n.range)}))}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData((function(){var r=e.selector.range,i=r.sri,o=r.sci,a=e.rows,u=e.merges,l=e.cols,c=i;"row"===t?a.insert(i,n):"column"===t&&(a.insertColumn(o,n),c=o,l.len+=n,Object.keys(l._).reverse().forEach((function(t){var e=parseInt(t,10);e>=o&&(l._[e+n]=l._[e],delete l._[e])}))),u.shift(t,c,n,(function(t,e,n,r){var i=a.getCell(t,e);i.merge[0]+=n,i.merge[1]+=r}))}))}},{key:"delete",value:function(t){var e=this;this.changeData((function(){var n=e.rows,r=e.merges,i=e.selector,o=e.cols,a=i.range,u=i.range,l=u.sri,c=u.sci,s=u.eri,f=u.eci,h=Ut(i.range.size(),2),y=h[0],p=h[1],v=l,d=y;"row"===t?n.delete(l,s):"column"===t&&(n.deleteColumn(c,f),v=a.sci,d=p,o.len-=f-c+1,Object.keys(o._).forEach((function(t){var e=parseInt(t,10);e>=c&&(e>f&&(o._[e-(f-c+1)]=o._[e]),delete o._[e])}))),r.shift(t,v,-d,(function(t,e,r,i){var o=n.getCell(t,e);o.merge[0]+=r,o.merge[1]+=i,0===o.merge[0]&&0===o.merge[1]&&delete o.merge}))}))}},{key:"scrollx",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.cols,o=Ut(r,2)[1],a=Ut(ot.rangeReduceIf(o,i.len,0,0,t,(function(t){return i.getWidth(t)})),3),u=a[0],l=a[1],c=a[2],s=l;t>0&&(s+=c),n.x!==s&&(n.ci=t>0?u:0,n.x=s,e())}},{key:"scrolly",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.rows,o=Ut(r,1)[0],a=Ut(ot.rangeReduceIf(o,i.len,0,0,t,(function(t){return i.getHeight(t)})),3),u=a[0],l=a[1],c=a[2],s=l;t>0&&(s+=c),n.y!==s&&(n.ri=t>0?u:0,n.y=s,e())}},{key:"cellRect",value:function(t,e){var n=this.rows,r=this.cols,i=r.sumWidth(0,e),o=n.sumHeight(0,t),a=n.getCell(t,e),u=r.getWidth(e),l=n.getHeight(t);if(null!==a&&a.merge){var c=Ut(a.merge,2),s=c[0],f=c[1];if(s>0)for(var h=1;h<=s;h+=1)l+=n.getHeight(t+h);if(f>0)for(var y=1;y<=f;y+=1)u+=r.getWidth(e+y)}return{left:i,top:o,width:u,height:l,cell:a}}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var n=this.getCell(t,e);return n&&n.text?n.text:""}},{key:"getCellStyle",value:function(t,e){var n=this.getCell(t,e);return n&&void 0!==n.style?this.styles[n.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var n=this.styles,r=this.rows.getCell(t,e),i=r&&void 0!==r.style?n[r.style]:{};return ot.merge(this.defaultStyle(),i)}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,n=t.ci;return this.getCellStyleOrDefault(e,n)}},{key:"setCellText",value:function(t,e,n,r){var i=this.rows,o=this.history,a=this.validations;"finished"===r?(i.setCellText(t,e,""),o.add(this.getData()),i.setCellText(t,e,n)):(i.setCellText(t,e,n),this.change(this.getData())),a.validate(t,e,n)}},{key:"freezeIsActive",value:function(){var t=Ut(this.freeze,2),e=t[0],n=t[1];return e>0||n>0}},{key:"setFreeze",value:function(t,e){var n=this;this.changeData((function(){n.freeze=[t,e]}))}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0])}},{key:"setRowHeight",value:function(t,e){var n=this;this.changeData((function(){n.rows.setHeight(t,e)}))}},{key:"setColWidth",value:function(t,e){var n=this;this.changeData((function(){n.cols.setWidth(t,e)}))}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,n=t.showToolbar,r=t.showBottomBar,i=e.height();return r&&(i-=41),n&&(i-=41),i}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=Ut(this.freeze,2),e=t[0],n=t[1];return new _(0,0,e-1,n-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,n=Ut(t.maxCell(),2),r=n[0],i=n[1],o=t.sumHeight(0,r+1),a=e.sumWidth(0,i+1);return new _(0,0,r,i,a,o)}},{key:"exceptRowTotalHeight",value:function(t,e){var n=this.exceptRowSet,r=this.rows,i=Array.from(n),o=0;return i.forEach((function(n){if(n<t||n>e){var i=r.getHeight(n);o+=i}})),o}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,n=this.cols,r=this.freeze,i=this.exceptRowSet,o=t.ri,a=t.ci;o<=0&&(o=Ut(r,1)[0]),a<=0&&(a=Ut(r,2)[1]);for(var u=0,l=0,c=[e.len,n.len],s=c[0],f=c[1],h=o;h<e.len&&(i.has(h)||(l+=e.getHeight(h),s=h),!(l>this.viewHeight()));h+=1);for(var y=a;y<n.len&&(f=y,!((u+=n.getWidth(y))>this.viewWidth()));y+=1);return new _(o,a,s,f,u,l)}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach((function(t){return e(t)}))}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,n=this.selector,r=Ut(n.size(),2),i=r[0],o=r[1],a=n.range,u=a.sri,l=a.sci,c=a.eri,s=a.eci;if(i===t.len)for(var f=l;f<=s;f+=1)e.setHide(f,!0);else if(o===e.len)for(var h=u;h<=c;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,n){for(var r=0,i=this.rows,o=this.exceptRowSet,a=qt(o),u=0,l=0;l<a.length;l+=1)a[l]<t&&(u+=1);for(var c=t+u;c<=e+u;c+=1)if(o.has(c))u+=1;else{var s=i.getHeight(c);if(s>0&&(n(c,r,s),(r+=s)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,n){for(var r=0,i=this.cols,o=t;o<=e;o+=1){var a=i.getWidth(o);if(a>0&&(n(o,r,a),(r+=a)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,n=0;n<e.length;n+=1){var r=e[n];if(ot.equals(r,t))return n}return e.push(t),e.length-1}},{key:"changeData",value:function(t){this.history.add(this.getData()),t(),this.change(this.getData())}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach((function(n){if("merges"===n||"rows"===n||"cols"===n||"validations"===n)e[n].setData(t[n]);else if("freeze"===n){var r=Ut(d(t[n]),2),i=r[0],o=r[1];e.freeze=[o,i]}else"autofilter"===n?e.autoFilter.setData(t[n]):void 0!==t[n]&&(e[n]=t[n])})),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,n=this.styles,r=this.merges,i=this.rows,o=this.cols,a=this.validations,u=this.autoFilter;return{name:t,freeze:b(e[1],e[0]),styles:n,merges:r.getData(),rows:i.getData(),cols:o.getData(),validations:a.getData(),autofilter:u.getData()}}}])&&Vt(t.prototype,e),n&&Vt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function re(t){return function(t){if(Array.isArray(t))return oe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ie(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(t,e){if(t){if("string"==typeof t)return oe(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(t,e):void 0}}function oe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ae(t,e,n){t.addEventListener(e,n)}function ue(t,e,n){t.removeEventListener(e,n)}function le(t){t.xclickoutside&&(ue(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function ce(t,e){t.xclickoutside=function(n){2===n.detail||t.contains(n.target)||(e?e(t):(t.hide(),le(t)))},ae(window.document.body,"click",t.xclickoutside)}function se(t,e,n){ae(t,"mousemove",e),t.xEvtUp=function(r){ue(t,"mousemove",e),ue(t,"mouseup",t.xEvtUp),n(r)},ae(t,"mouseup",t.xEvtUp)}function fe(t,e,n,r){Math.abs(t)>Math.abs(e)?r(t>0?"right":"left",t,n):r(e>0?"down":"up",e,n)}function he(){var t=new Map;function e(e,n){var r;return t.has(e)&&(r=t.get(e),Array.isArray(r)&&r.push(n)||!1)||t.set(e,[].concat(n))}function n(e,n){var r,i;return t.has(e)&&(r=t.get(e),(i=r.indexOf(n))>=0&&r.splice(i,1)&&0===t.get(e).length&&t.delete(e))}return{get current(){return t},on:e,once:function(t,r){var i=function(){for(var e=arguments.length,o=new Array(e),a=0;a<e;a++)o[a]=arguments[a];r.call.apply(r,[null].concat(o)),n(t,i)};return e(t,i)},fire:function(e,n){return t.has(e)&&function(){var r,i=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=ie(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}(t.get(e));try{for(i.s();!(r=i.n()).done;){var o=r.value;o.call.apply(o,[null].concat(re(n)))}}catch(t){i.e(t)}finally{i.f()}}()},removeListener:n,removeAllListeners:function(){t.clear()}}}var ye="x-spreadsheet";window.devicePixelRatio;function pe(t){return(pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,be(r.key),r)}}function be(t){var e=function(t,e){if("object"!=pe(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pe(e)?e:e+""}var me=function(){return t=function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1?arguments[1]:void 0;ve(this,t),this.moving=!1,this.vertical=n,this.el=s("div","".concat(ye,"-resizer ").concat(n?"vertical":"horizontal")).children(this.unhideHoverEl=s("div","".concat(ye,"-resizer-hover")).on("dblclick.stop",(function(t){return e.mousedblclickHandler(t)})).css("position","absolute").hide(),this.hoverEl=s("div","".concat(ye,"-resizer-hover")).on("mousedown.stop",(function(t){return e.mousedownHandler(t)})),this.lineEl=s("div","".concat(ye,"-resizer-line")).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=r,this.unhideFn=function(){}},(e=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e){var n=this.moving,r=this.vertical,i=this.hoverEl,o=this.lineEl,a=this.el,u=this.unhideHoverEl;if(!n){this.cRect=t;var l=t.left,c=t.top,s=t.width,f=t.height;a.offset({left:r?l+s-5:l,top:r?c:c+f-5}).show(),i.offset({width:r?5:s,height:r?f:5}),o.offset({width:r?0:e.width,height:r?e.height:0}),u.offset({left:r?5-s:l,top:r?c:5-f,width:r?5:s,height:r?f:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,n=t,r=this.el,i=this.lineEl,o=this.cRect,a=this.vertical,u=this.minDistance,l=a?o.width:o.height;i.show(),se(window,(function(t){e.moving=!0,null!==n&&1===t.buttons&&(a?(l+=t.movementX)>u&&r.css("left","".concat(o.left+l,"px")):(l+=t.movementY)>u&&r.css("top","".concat(o.top+l,"px")),n=t)}),(function(){n=null,i.hide(),e.moving=!1,e.hide(),e.finishedFn&&(l<u&&(l=u),e.finishedFn(o,l))}))}}])&&de(t.prototype,e),n&&de(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ge(t){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function we(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Se(r.key),r)}}function Se(t){var e=function(t,e){if("object"!=ge(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ge(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ge(e)?e:e+""}var Oe=function(){return t=function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=s("div","".concat(ye,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=s("div","")).on("mousemove.stop",(function(){})).on("scroll.stop",(function(t){var e=t.target,r=e.scrollTop,i=e.scrollLeft;n.moveFn&&n.moveFn(n.vertical?r:i,t)}))},(e=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var n=t-1;if(e>n){var r=this.vertical?"height":"width";this.el.css(r,"".concat(n-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(r,"".concat(e,"px"))}else this.el.hide();return this}}])&&we(t.prototype,e),n&&we(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ke(t){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function je(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Pe(r.key),r)}}function xe(t,e,n){return e&&_e(t.prototype,e),n&&_e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pe(t){var e=function(t,e){if("object"!=ke(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ke(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ke(e)?e:e+""}var Ee=10,Ae=function(){return xe((function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];je(this,t),this.useHideInput=n,this.autoFocus=r,this.inputChange=function(){},this.cornerEl=s("div","".concat(ye,"-selector-corner")),this.areaEl=s("div","".concat(ye,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=s("div","".concat(ye,"-selector-clipboard")).hide(),this.autofillEl=s("div","".concat(ye,"-selector-autofill")).hide(),this.el=s("div","".concat(ye,"-selector")).css("z-index","".concat(Ee)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),n&&(this.hideInput=s("input","").on("compositionend",(function(t){e.inputChange(t.target.value)})),this.el.child(this.hideInputDiv=s("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=s("div","hide-input").child(this.hideInput))),Ee+=1}),[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,n=t.top,r={width:t.width-3+.8,height:t.height-3+.8,left:e-.8,top:n-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.autoFocus?this.hideInput.val("").focus():this.hideInput.val(""))}},{key:"setClipboardOffset",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.clipboardEl.offset({left:e,top:n,width:r-5,height:i-5})}},{key:"showAutofill",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.autofillEl.offset({width:r-3,height:i-3,left:e,top:n}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}])}();function Te(t){var e=this.data,n=t.left,r=t.top,i=t.width,o=t.height,a=t.scroll,u=t.l,l=t.t,c=e.freezeTotalWidth(),s=e.freezeTotalHeight(),f=n-c;c>u&&(f-=a.x);var h=r-s;return s>l&&(h-=a.y),{left:f,top:h,width:i,height:o}}function Ce(t){var e=this.data,n=t.left,r=t.width,i=t.height,o=t.l,a=t.t,u=t.scroll,l=e.freezeTotalWidth(),c=n-l;return l>o&&(c-=u.x),{left:c,top:a,width:r,height:i}}function Me(t){var e=this.data,n=t.top,r=t.width,i=t.height,o=t.l,a=t.t,u=t.scroll,l=e.freezeTotalHeight(),c=n-l;return l>a&&(c-=u.y),{left:o,top:c,width:r,height:i}}function Re(t){this.br.setAreaOffset(Te.call(this,t))}function Ne(t){this.tl.setAreaOffset(t)}function Ie(t){this.t.setAreaOffset(Ce.call(this,t))}function De(t){this.l.setAreaOffset(Me.call(this,t))}function $e(t){this.l.setClipboardOffset(Me.call(this,t))}function ze(t){this.br.setClipboardOffset(Te.call(this,t))}function Be(t){this.tl.setClipboardOffset(t)}function He(t){this.t.setClipboardOffset(Ce.call(this,t))}function Fe(t){Re.call(this,t),Ne.call(this,t),Ie.call(this,t),De.call(this,t)}function qe(t){ze.call(this,t),Be.call(this,t),He.call(this,t),$e.call(this,t)}var Ve=function(){return xe((function t(e){var n=this;je(this,t);var r=e.settings.autoFocus;this.inputChange=function(){},this.data=e,this.br=new Ae(!0,r),this.t=new Ae,this.l=new Ae,this.tl=new Ae,this.br.inputChange=function(t){n.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=s("div","".concat(ye,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Ee+=1}),[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,n=this.t,r=this.l,i=this.br,o=t.freezeTotalHeight(),a=t.freezeTotalWidth();o>0||a>0?(e.setOffset({width:a,height:o}),n.setOffset({left:a,height:o}),r.setOffset({top:o,width:a}),i.setOffset({left:a,top:o})):(e.hide(),n.hide(),r.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Fe.call(this,t),qe.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Re.call(this,t),Ie.call(this,t),ze.call(this,e),He.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Re.call(this,t),De.call(this,t),ze.call(this,e),$e.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=r.calSelectedRangeByStart(t,e),o=i.sri,a=i.sci;if(n){var u=t,l=e;t<0&&(u=0),e<0&&(l=0),r.selector.setIndexes(u,l),this.indexes=[u,l]}this.moveIndexes=[o,a],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=this.lastri,o=this.lastci;if(n){if(t===i&&e===o)return;this.lastri=t,this.lastci=e}this.range=r.calSelectedRangeByEnd(t,e),Fe.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,n=t.eci;this.setEnd(e,n)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var n=this.range,r=n.sri,i=n.sci,o=n.eri,a=n.eci,u=t,l=e,c=r-t,s=o-t,f=a-e;if(i-e>0)this.arange=new _(r,l,o,i-1);else if(c>0)this.arange=new _(u,i,r-1,a);else if(f<0)this.arange=new _(r,a+1,o,l);else{if(!(s<0))return void(this.arange=null);this.arange=new _(o+1,i,u,a)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var y=this.br,p=this.l,v=this.t,d=this.tl;y.showAutofill(Te.call(this,h)),p.showAutofill(Me.call(this,h)),v.showAutofill(Ce.call(this,h)),d.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideAutofill()}))}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();qe.call(this,e),["br","l","t","tl"].forEach((function(e){t[e].showClipboard()}))}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach((function(e){t[e].hideClipboard()}))}}])}();function We(t){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ue(t){return function(t){if(Array.isArray(t))return Le(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Le(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Le(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Xe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ye(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ze(r.key),r)}}function Ze(t){var e=function(t,e){if("object"!=We(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=We(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==We(e)?e:e+""}function Ke(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}function Je(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}function Ge(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}function Qe(t){var e=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),e){case 37:t.stopPropagation();break;case 38:Ke.call(this,t);break;case 39:t.stopPropagation();break;case 40:Je.call(this,t);break;case 13:case 9:Ge.call(this,t);break;default:t.stopPropagation()}}var tn=function(){return t=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";Xe(this,t),this.filterItems=[],this.items=e,this.el=s("div","".concat(ye,"-suggest")).css("width",r).hide(),this.itemClick=n,this.itemIndex=-1},(e=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),le(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,n=this,r=this.items;if(/^\s*$/.test(t)||(r=r.filter((function(e){return(e.key||e).startsWith(t.toUpperCase())}))),r=r.map((function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var r=s("div","".concat(ye,"-item")).child(e).on("click.stop",(function(){n.itemClick(t),n.hide()}));return t.label&&r.child(s("div","label").html(t.label)),r})),this.filterItems=r,!(r.length<=0)){var i=this.el;(e=i.html("")).children.apply(e,Ue(r)).show(),ce(i.parent(),(function(){n.hide()}))}}},{key:"bindInputEvents",value:function(t){var e=this;t.on("keydown",(function(t){return Qe.call(e,t)}))}}])&&Ye(t.prototype,e),n&&Ye(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function en(t){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rn(r.key),r)}}function rn(t){var e=function(t,e){if("object"!=en(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=en(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==en(e)?e:e+""}function on(t,e,n){return e=an(e),function(t,e){if(e&&("object"==en(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],an(t).constructor):e.apply(t,n))}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function un(t,e){return(un=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ln=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=on(this,e,["div","".concat(ye,"-icon")])).iconNameEl=s("div","".concat(ye,"-icon-img ").concat(t)),n.child(n.iconNameEl),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&un(t,e)}(e,t),n=e,(r=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(ye,"-icon-img ").concat(t))}}])&&nn(n.prototype,r),i&&nn(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(c);function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sn(t){return function(t){if(Array.isArray(t))return fn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return fn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function hn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yn(r.key),r)}}function yn(t){var e=function(t,e){if("object"!=cn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=cn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==cn(e)?e:e+""}function pn(t,e){t.setMonth(t.getMonth()+e)}function vn(t,e){var n=new Date(t);return n.setDate(e-t.getDay()+1),n}var dn=function(){return t=function t(e){var n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=s("div","calendar-header-left"),this.bodyEl=s("tbody",""),this.buildAll(),this.el=s("div","x-spreadsheet-calendar").children(s("div","calendar-header").children(this.headerLeftEl,s("div","calendar-header-right").children(s("a","calendar-prev").on("click.stop",(function(){return r.prev()})).child(new ln("chevron-left")),s("a","calendar-next").on("click.stop",(function(){return r.next()})).child(new ln("chevron-right")))),s("table","calendar-body").children(s("thead","").child((n=s("tr","")).children.apply(n,sn(St("calendar.weeks").map((function(t){return s("th","cell").child(t)}))))),this.bodyEl)),this.selectChange=function(){}},(e=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){pn(this.value,-1),this.buildAll()}},{key:"next",value:function(){pn(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(St("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,n=this.value,r=this.cvalue,i=this.bodyEl,o=function(t,e,n){for(var r=new Date(t,e,1,23,59,59),i=[[],[],[],[],[],[]],o=0;o<6;o+=1)for(var a=0;a<7;a+=1){var u=vn(r,7*o+a),l=u.getMonth()!==e,c=u.getMonth()===n.getMonth()&&u.getDate()===n.getDate();i[o][a]={d:u,disabled:l,active:c}}return i}(n.getFullYear(),n.getMonth(),r).map((function(t){var n,r=t.map((function(t){var n="cell";return t.disabled&&(n+=" disabled"),t.active&&(n+=" active"),s("td","").child(s("div",n).on("click.stop",(function(){e.selectChange(t.d)})).child(t.d.getDate().toString()))}));return(n=s("tr","")).children.apply(n,sn(r))}));(t=i.html("")).children.apply(t,sn(o))}}])&&hn(t.prototype,e),n&&hn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function bn(t){return(bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,gn(r.key),r)}}function gn(t){var e=function(t,e){if("object"!=bn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=bn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==bn(e)?e:e+""}var wn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new dn(new Date),this.el=s("div","".concat(ye,"-datepicker")).child(this.calendar.el).hide()},(e=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(n){t(n),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&mn(t.prototype,e),n&&mn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function Sn(t){return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function On(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kn(r.key),r)}}function kn(t){var e=function(t,e){if("object"!=Sn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Sn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Sn(e)?e:e+""}function jn(t){return function(t){if(Array.isArray(t))return _n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return _n(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function xn(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,n=this.textEl,r=this.areaOffset,i=t.split("\n"),o=Math.max.apply(Math,jn(i.map((function(t){return t.length})))),a=e.offset().width/t.length,u=(o+1)*a+5,l=this.viewFn().width-r.left-a,c=i.length;if(u>r.width){var s=u;u>l&&(s=l,c+=parseInt(u/l,10),c+=u%l>0?1:0),n.css("width","".concat(s,"px"))}(c*=this.rowHeight)>r.height&&n.css("height","".concat(c,"px"))}}function Pn(t,e){var n=t.target,r=n.value,i=n.selectionEnd,o="".concat(r.slice(0,i)).concat(e).concat(r.slice(i));n.value=o,n.setSelectionRange(i+1,i+1),this.inputText=o,this.textlineEl.html(o),xn.call(this)}function En(t){var e=t.keyCode,n=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&n&&(Pn.call(this,t,"\n"),t.stopPropagation()),13!==e||n||t.preventDefault()}function An(t){var e=t.target.value,n=this.suggest,r=this.textlineEl,i=this.validator,o=this.cell;if(null!==o)if("editable"in o&&!0===o.editable||void 0===o.editable){if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var a=e.lastIndexOf("=");-1!==a?n.search(e.substring(a+1)):n.hide()}r.html(e),xn.call(this),this.change("input",e)}else t.target.value=o.text||"";else{if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var u=e.lastIndexOf("=");-1!==u?n.search(e.substring(u+1)):n.hide()}r.html(e),xn.call(this),this.change("input",e)}}function Tn(t){var e=this.textEl.el;setTimeout((function(){e.focus(),e.setSelectionRange(t,t)}),0)}function Cn(t,e){var n=this.textEl,r=this.textlineEl;n.el.blur(),n.val(t),r.html(t),Tn.call(this,e)}function Mn(t){var e=this.inputText,n=this.validator,r=0;if(n&&"list"===n.type)this.inputText=t,r=this.inputText.length;else{var i=e.lastIndexOf("="),o=e.substring(0,i+1),a=e.substring(i+1);a=-1!==a.indexOf(")")?a.substring(a.indexOf(")")):"",this.inputText="".concat(o+t.key,"("),r=this.inputText.length,this.inputText+=")".concat(a)}Cn.call(this,this.inputText,r)}function Rn(){this.suggest.setItems(this.formulas)}var Nn=function(){return function(t,e,n){return e&&On(t.prototype,e),n&&On(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(e,n,r){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=n,this.rowHeight=r,this.formulas=e,this.suggest=new tn(e,(function(t){Mn.call(i,t)})),this.datepicker=new wn,this.datepicker.change((function(t){i.setText(function(t){var e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0".concat(e)),n<10&&(n="0".concat(n)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(n)}(t)),i.clear()})),this.areaEl=s("div","".concat(ye,"-editor-area")).children(this.textEl=s("textarea","").on("input",(function(t){return An.call(i,t)})).on("paste.stop",(function(){})).on("keydown",(function(t){return En.call(i,t)})),this.textlineEl=s("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",(function(){})).on("mousedown.stop",(function(){})),this.el=s("div","".concat(ye,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}),[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),Rn.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n=this.textEl,r=this.areaEl,i=this.suggest,o=this.freeze,a=this.el;if(t){this.areaOffset=t;var u=t.left,l=t.top,c=t.width,s=t.height,f=t.l,h=t.t,y={left:0,top:0};o.w>f&&o.h>h||(o.w<f&&o.h<h?(y.left=o.w,y.top=o.h):o.w>f?y.top=o.h:o.h>h&&(y.left=o.w)),a.offset(y),r.offset({left:u-y.left-.8,top:l-y.top-.8}),n.offset({width:c-9+.8,height:s-3+.8});var p={left:0};p[e]=s,i.setOffset(p),i.hide()}}},{key:"setCell",value:function(t,e){if(!t||!1!==t.editable){var n=this.el,r=this.datepicker,i=this.suggest;n.show(),this.cell=t;var o=t&&t.text||"";if(this.setText(o),this.validator=e,e){var a=e.type;"date"===a&&(r.show(),/^\s*$/.test(o)||r.setValue(o)),"list"===a&&(i.setItems(e.values()),i.search(""))}}}},{key:"setText",value:function(t){this.inputText=t,Cn.call(this,t,t.length),xn.call(this)}}])}();function In(t){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$n(r.key),r)}}function $n(t){var e=function(t,e){if("object"!=In(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=In(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==In(e)?e:e+""}function zn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bn(t,e,n){return e=Hn(e),function(t,e){if(e&&("object"==In(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Hn(t).constructor):e.apply(t,n))}function Hn(t){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fn(t,e){return(Fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var qn=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return zn(this,e),(n=Bn(this,e,["div","".concat(ye,"-button ").concat(r)])).child(St("button.".concat(t))),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fn(t,e)}(e,t),n=e,r&&Dn(n.prototype,r),i&&Dn(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(c);function Vn(t){return function(t){if(Array.isArray(t))return Ln(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Un(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||Un(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Un(t,e){if(t){if("string"==typeof t)return Ln(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ln(t,e):void 0}}function Ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Xn(t){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Jn(r.key),r)}}function Kn(t,e,n){return e&&Zn(t.prototype,e),n&&Zn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jn(t){var e=function(t,e){if("object"!=Xn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Xn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xn(e)?e:e+""}function Gn(){return window.devicePixelRatio||1}function Qn(){return Gn()-.5}function tr(t){return parseInt(t*Gn(),10)}function er(t){var e=tr(t);return e>0?e-.5:.5}var nr=function(){return Kn((function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Yn(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.padding=o,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}),[{key:"setBorders",value:function(t){var e=t.top,n=t.bottom,r=t.left,i=t.right;e&&(this.borderTop=e),i&&(this.borderRight=i),n&&(this.borderBottom=n),r&&(this.borderLeft=r)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,n=this.padding,r=this.x;return"left"===t?r+=n:"center"===t?r+=e/2:"right"===t&&(r+=e-n),r}},{key:"texty",value:function(t,e){var n=this.height,r=this.padding,i=this.y;return"top"===t?i+=r:"middle"===t?i+=n/2-e/2:"bottom"===t&&(i+=n-r-e),i}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,n=this.width;return[[t+n,e],[t+n,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return[[t,e+r],[t+n,e+r]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}])}();function rr(t,e,n,r,i,o,a){var u={x:0,y:0};"underline"===t?u.y="bottom"===i?0:"top"===i?-(o+2):-o/2:"strike"===t&&("bottom"===i?u.y=o/2:"top"===i&&(u.y=-(o/2+2))),"center"===r?u.x=a/2:"right"===r&&(u.x=a),this.line([e-u.x,n-u.y],[e-u.x+a,n-u.y])}var ir=function(){return Kn((function t(e,n,r){Yn(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(n,r),this.ctx.scale(Gn(),Gn())}),[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=tr(t),this.el.height=tr(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,n=t.height;return this.ctx.clearRect(0,0,e,n),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(tr(t),tr(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,n,r){return this.ctx.clearRect(t,e,n,r),this}},{key:"fillRect",value:function(t,e,n,r){return this.ctx.fillRect(tr(t)-.5,tr(e)-.5,tr(n),tr(r)),this}},{key:"fillText",value:function(t,e,n){return this.ctx.fillText(t,tr(e),tr(n)),this}},{key:"text",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this.ctx,a=r.align,u=r.valign,l=r.font,c=r.color,s=r.strike,f=r.underline,h=e.textx(a);o.save(),o.beginPath(),this.attr({textAlign:a,textBaseline:u,font:"".concat(l.italic?"italic":""," ").concat(l.bold?"bold":""," ").concat(tr(l.size),"px ").concat(l.name),fillStyle:c,strokeStyle:c});var y="".concat(t).split("\n"),p=e.innerWidth(),v=[];y.forEach((function(t){var e=o.measureText(t).width;if(i&&e>tr(p)){for(var n={w:0,len:0,start:0},r=0;r<t.length;r+=1)n.w>=tr(p)&&(v.push(t.substr(n.start,n.len)),n={w:0,len:0,start:r}),n.len+=1,n.w+=o.measureText(t[r]).width+1;n.len>0&&v.push(t.substr(n.start,n.len))}else v.push(t)}));var d=(v.length-1)*(l.size+2),b=e.texty(u,d);return v.forEach((function(t){var e=o.measureText(t).width;n.fillText(t,h,b),s&&rr.call(n,"strike",h,b,a,u,l.size,e),f&&rr.call(n,"underline",h,b,a,u,l.size,e),b+=l.size+2})),o.restore(),this}},{key:"border",value:function(t,e){var n=this.ctx;return n.lineWidth=Qn,n.strokeStyle=e,"medium"===t?n.lineWidth=tr(2)-.5:"thick"===t?n.lineWidth=tr(3):"dashed"===t?n.setLineDash([tr(3),tr(2)]):"dotted"===t?n.setLineDash([tr(1),tr(1)]):"double"===t&&n.setLineDash([tr(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],n=Wn(e,2),r=n[0],i=n[1];t.moveTo(er(r),er(i));for(var o=1;o<arguments.length;o+=1){var a=o<0||arguments.length<=o?void 0:arguments[o],u=Wn(a,2),l=u[0],c=u[1];t.lineTo(er(l),er(c))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var n=t.borderTop,r=t.borderRight,i=t.borderBottom,o=t.borderLeft;n&&(this.border.apply(this,Vn(n)),this.line.apply(this,Vn(t.topxys()))),r&&(this.border.apply(this,Vn(r)),this.line.apply(this,Vn(t.rightxys()))),i&&(this.border.apply(this,Vn(i)),this.line.apply(this,Vn(t.bottomxys()))),o&&(this.border.apply(this,Vn(o)),this.line.apply(this,Vn(t.leftxys()))),e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-15,o=r+t.height-15;e.save(),e.beginPath(),e.moveTo(tr(i),tr(o)),e.lineTo(tr(i+8),tr(o)),e.lineTo(tr(i+4),tr(o+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(tr(i-8),tr(r-1)),e.lineTo(tr(i),tr(r-1)),e.lineTo(tr(i),tr(r+8)),e.closePath(),e.fillStyle="rgba(255, 0, 0, .65)",e.fill(),e.restore()}},{key:"frozen",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(tr(i-8),tr(r-1)),e.lineTo(tr(i),tr(r-1)),e.lineTo(tr(i),tr(r+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var n=this.ctx,r=t.x,i=t.y,o=t.width,a=t.height,u=t.bgcolor;n.save(),n.beginPath(),n.fillStyle=u||"#fff",n.rect(er(r+1),er(i+1),tr(o-2),tr(a-2)),n.clip(),n.fill(),e(),n.restore()}}])}(),or=[{key:"Arial",title:"Arial"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"}],ar=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function ur(t){for(var e=0;e<ar.length;e+=1){var n=ar[e];if(n.pt===t)return n.px}return t}function lr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return cr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var sr=function(t){for(var e=[],n=[],r=[],i=0,o="",a=1,u="",l=0;l<t.length;l+=1){var c=t.charAt(l);if(" "!==c){if(c>="a"&&c<="z")r.push(c.toUpperCase());else if(c>="0"&&c<="9"||c>="A"&&c<="Z"||"."===c)r.push(c);else if('"'===c){for(l+=1;'"'!==t.charAt(l);)r.push(t.charAt(l)),l+=1;n.push('"'.concat(r.join(""))),r=[]}else if("-"===c&&/[+\-*/,(]/.test(u))r.push(c);else{if("("!==c&&r.length>0&&n.push(r.join("")),")"===c){var s=e.pop();if(2===i)try{for(var f=lr(d(n.pop()),2),h=f[0],y=f[1],p=lr(d(n.pop()),2),v=p[0],m=p[1],g=0,w=v;w<=h;w+=1)for(var S=m;S<=y;S+=1)n.push(b(w,S)),g+=1;n.push([s,g])}catch(t){}else if(1===i||3===i)3===i&&n.push(o),n.push([s,a]),a=1;else for(;"("!==s&&(n.push(s),!(e.length<=0));)s=e.pop();i=0}else if("="===c||">"===c||"<"===c){var O=t.charAt(l+1);o=c,"="!==O&&"-"!==O||(o+=O,l+=1),i=3}else if(":"===c)i=2;else if(","===c)3===i&&n.push(o),i=1,a+=1;else if("("===c&&r.length>0)e.push(r.join(""));else{if(e.length>0&&("+"===c||"-"===c)){var k=e[e.length-1];if("("!==k&&n.push(e.pop()),"*"===k||"/"===k)for(;e.length>0&&"("!==(k=e[e.length-1]);)n.push(e.pop())}else if(e.length>0){var j=e[e.length-1];"*"!==j&&"/"!==j||n.push(e.pop())}e.push(c)}r=[]}u=c}}for(r.length>0&&n.push(r.join(""));e.length>0;)n.push(e.pop());return n},fr=function(t,e){var n=lr(t,1)[0],r=t;if('"'===n)return t.substring(1);var i=1;if("-"===n&&(r=t.substring(1),i=-1),r[0]>="0"&&r[0]<="9")return i*Number(r);var o=lr(d(r),2);return i*e(o[0],o[1])},hr=function(t,e,n,r){for(var i=[],o=0;o<t.length;o+=1){var a=t[o],u=a[0];if("+"===a){var l=i.pop();i.push(it("+",i.pop(),l))}else if("-"===a)if(1===i.length){var c=i.pop();i.push(it("*",c,-1))}else{var s=i.pop();i.push(it("-",i.pop(),s))}else if("*"===a)i.push(it("*",i.pop(),i.pop()));else if("/"===a){var f=i.pop();i.push(it("/",i.pop(),f))}else if("="===u||">"===u||"<"===u){var h=i.pop();Number.isNaN(h)||(h=Number(h));var y=i.pop();Number.isNaN(y)||(y=Number(y));var p=!1;"="===u?p=y===h:">"===a?p=y>h:">="===a?p=y>=h:"<"===a?p=y<h:"<="===a&&(p=y<=h),i.push(p)}else if(Array.isArray(a)){for(var v=lr(a,2),d=v[0],b=v[1],m=[],g=0;g<b;g+=1)m.push(i.pop());i.push(e[d].render(m.reverse()))}else{if(r.includes(a))return 0;(u>="a"&&u<="z"||u>="A"&&u<="Z")&&r.push(a),i.push(fr(a,n)),r.pop()}}return i[0]},yr=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===t[0]){var i=sr(t.substring(1));return i.length<=0?t:hr(i,e,(function(t,i){return yr(n(t,i),e,n,r)}),r)}return t},pr={render:yr};function vr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||br(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dr(t){return function(t){if(Array.isArray(t))return mr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||br(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function br(t,e){if(t){if("string"==typeof t)return mr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mr(t,e):void 0}}function mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var gr=[{key:"SUM",title:Ot("formula.sum"),render:function(t){return t.reduce((function(t,e){return it("+",t,e)}),0)}},{key:"AVERAGE",title:Ot("formula.average"),render:function(t){return t.reduce((function(t,e){return Number(t)+Number(e)}),0)/t.length}},{key:"MAX",title:Ot("formula.max"),render:function(t){return Math.max.apply(Math,dr(t.map((function(t){return Number(t)}))))}},{key:"MIN",title:Ot("formula.min"),render:function(t){return Math.min.apply(Math,dr(t.map((function(t){return Number(t)}))))}},{key:"IF",title:Ot("formula._if"),render:function(t){var e=vr(t,3),n=e[0],r=e[1],i=e[2];return n?r:i}},{key:"AND",title:Ot("formula.and"),render:function(t){return t.every((function(t){return t}))}},{key:"OR",title:Ot("formula.or"),render:function(t){return t.some((function(t){return t}))}},{key:"CONCAT",title:Ot("formula.concat"),render:function(t){return t.join("")}}],wr=gr,Sr={};function Or(t){return function(t){if(Array.isArray(t))return _r(t)}(t)||xr(t)||jr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kr(t){return function(t){if(Array.isArray(t))return t}(t)||xr(t)||jr(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jr(t,e){if(t){if("string"==typeof t)return _r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_r(t,e):void 0}}function _r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function xr(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}gr.forEach((function(t){Sr[t.key]=t}));var Pr=function(t){return t},Er=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=kr(Number(t).toFixed(2).toString().split("\\.")),n=e[0],r=_r(e).slice(1);return[n.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(Or(r))}return t},Ar=[{key:"normal",title:Ot("format.normal"),type:"string",render:Pr},{key:"text",title:Ot("format.text"),type:"string",render:Pr},{key:"number",title:Ot("format.number"),type:"number",label:"1,000.12",render:Er},{key:"percent",title:Ot("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:Ot("format.rmb"),type:"number",label:"10.00",render:function(t){return"".concat(Er(t))}},{key:"usd",title:Ot("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(Er(t))}},{key:"eur",title:Ot("format.eur"),type:"number",label:"10.00",render:function(t){return"".concat(Er(t))}},{key:"date",title:Ot("format.date"),type:"date",label:"26/09/2008",render:Pr},{key:"time",title:Ot("format.time"),type:"date",label:"15:59:00",render:Pr},{key:"datetime",title:Ot("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:Pr},{key:"duration",title:Ot("format.duration"),type:"date",label:"24:01:00",render:Pr}],Tr={};function Cr(t){return(Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Rr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Nr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ir(r.key),r)}}function Ir(t){var e=function(t,e){if("object"!=Cr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Cr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Cr(e)?e:e+""}Ar.forEach((function(t){Tr[t.key]=t}));var Dr={fillStyle:"#f4f5f8"},$r={fillStyle:"#fff",lineWidth:Qn,strokeStyle:"#e6e6e6"};function zr(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.cellRect(e,n),o=i.left,a=i.top,u=i.width,l=i.height;return new nr(o,a+r,u,l,5)}function Br(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=e.sortedRowMap,a=e.rows,u=e.cols;if(!a.isHide(n)&&!u.isHide(r)){var l=n;o.has(n)&&(l=o.get(n));var c=e.getCell(l,r);if(null!==c){var s=!1;"editable"in c&&!1===c.editable&&(s=!0);var f=e.getCellStyleOrDefault(l,r),h=zr(e,n,r,i);h.bgcolor=f.bgcolor,void 0!==f.border&&(h.setBorders(f.border),t.strokeBorders(h)),t.rect(h,(function(){var i="";i=e.settings.evalPaused?c.text||"":pr.render(c.text||"",Sr,(function(t,n){return e.getCellTextOrDefault(n,t)})),f.format&&(i=Tr[f.format].render(i));var o=Object.assign({},f.font);o.size=ur(o.size),t.text(i,h,{align:f.align,valign:f.valign,font:o,color:f.color,strike:f.strike,underline:f.underline},f.textwrap),e.validations.getError(n,r)&&t.error(h),s&&t.frozen(h)}))}}}function Hr(t){var e=this.data,n=this.draw;if(t){var r=e.autoFilter;if(!r.active())return;var i=r.hrange();t.intersects(i)&&i.each((function(t,r){var i=zr(e,t,r);n.dropdown(i)}))}}function Fr(t,e,n,r,i){var o=this.draw,a=this.data;o.save(),o.translate(e,n).translate(r,i);var u=a.exceptRowSet,l=a.exceptRowTotalHeight(t.sri,t.eri);o.save(),o.translate(0,-l),t.each((function(t,e){Br(o,a,t,e)}),(function(t){return function(t){var e=u.has(t);if(e){var n=a.rows.getHeight(t);o.translate(0,-n)}return!e}(t)})),o.restore();var c=new Set;o.save(),o.translate(0,-l),a.eachMergesInView(t,(function(t){var e=t.sri,n=t.sci,r=t.eri;if(u.has(e)){if(!c.has(e)){c.add(e);var i=a.rows.sumHeight(e,r+1);o.translate(0,-i)}}else Br(o,a,e,n)})),o.restore(),Hr.call(this,t),o.restore()}function qr(t,e,n,r){var i=this.draw;i.save(),i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,n,r),i.restore()}function Vr(t,e,n,r,i,o){var a=this,u=this.draw,l=this.data,c=e.h,s=e.w,f=o+r,h=i+n;u.save(),u.attr(Dr),"all"!==t&&"left"!==t||u.fillRect(0,f,n,c),"all"!==t&&"top"!==t||u.fillRect(h,0,s,r);var y=l.selector.range,v=y.sri,d=y.sci,b=y.eri,m=y.eci;u.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(tr(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:Qn(),strokeStyle:"#e6e6e6"}),"all"!==t&&"left"!==t||(l.rowEach(e.sri,e.eri,(function(t,e,r){var i=f+e,o=t;u.line([0,i],[n,i]),v<=o&&o<b+1&&qr.call(a,0,i,n,r),u.fillText(o+1,n/2,i+r/2),t>0&&l.rows.isHide(t-1)&&(u.save(),u.attr({strokeStyle:"#c6c6c6"}),u.line([5,i+5],[n-5,i+5]),u.restore())})),u.line([0,c+f],[n,c+f]),u.line([n,f],[n,c+f])),"all"!==t&&"top"!==t||(l.colEach(e.sci,e.eci,(function(t,e,n){var i=h+e,o=t;u.line([i,0],[i,r]),d<=o&&o<m+1&&qr.call(a,i,0,n,r),u.fillText(p(o),i+n/2,r/2),t>0&&l.cols.isHide(t-1)&&(u.save(),u.attr({strokeStyle:"#c6c6c6"}),u.line([i+5,5],[i+5,r-5]),u.restore())})),u.line([s+h,0],[s+h,r]),u.line([0,r],[s+h,r])),u.restore()}function Wr(t,e){var n=this.draw;n.save(),n.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),n.restore()}function Ur(t,e,n,r,i){var o=t.sri,a=t.sci,u=t.eri,l=t.eci,c=t.w,s=t.h,f=this.draw,h=this.data,y=h.settings;f.save(),f.attr($r).translate(e+r,n+i),y.showGrid?(h.rowEach(o,u,(function(t,e,n){t!==o&&f.line([0,e],[c,e]),t===u&&f.line([0,e+n],[c,e+n])})),h.colEach(a,l,(function(t,e,n){t!==a&&f.line([e,0],[e,s]),t===l&&f.line([e+n,0],[e+n,s])})),f.restore()):f.restore()}function Lr(t,e,n,r){var i=this.draw,o=this.data,a=o.viewWidth()-t,u=o.viewHeight()-e;i.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),i.line([0,r],[a,r]),i.line([n,0],[n,u]),i.restore()}var Xr=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new ir(e,n.viewWidth(),n.viewHeight()),this.data=n},(e=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data,e=t.rows,n=t.cols.indexWidth,r=e.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var i=t.viewRange(),o=t.freezeTotalWidth(),a=t.freezeTotalHeight(),u=t.scroll,l=u.x,c=u.y;Ur.call(this,i,n,r,o,a),Fr.call(this,i,n,r,-l,-c),Vr.call(this,"all",i,n,r,o,a),Wr.call(this,n,r);var s=Mr(t.freeze,2),f=s[0],h=s[1];if(f>0||h>0){if(f>0){var y=i.clone();y.sri=0,y.eri=f-1,y.h=a,Ur.call(this,y,n,r,o,0),Fr.call(this,y,n,r,-l,0),Vr.call(this,"top",y,n,r,o,0)}if(h>0){var p=i.clone();p.sci=0,p.eci=h-1,p.w=o,Ur.call(this,p,n,r,0,a),Vr.call(this,"left",p,n,r,0,a),Fr.call(this,p,n,r,0,-c)}var v=t.freezeViewRange();Ur.call(this,v,n,r,0,0),Vr.call(this,"all",v,n,r,0,0),Fr.call(this,v,n,r,0,0),Lr.call(this,n,r,o,a)}}},{key:"clear",value:function(){this.draw.clear()}}])&&Nr(t.prototype,e),n&&Nr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function Yr(t){return(Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zr(t){return function(t){if(Array.isArray(t))return Kr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Kr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gr(r.key),r)}}function Gr(t){var e=function(t,e){if("object"!=Yr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Yr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Yr(e)?e:e+""}var Qr=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],ti=["landscape","portrait"];function ei(t){return parseInt(96*t,10)}function ni(t){"cancel"===t?this.el.hide():this.toPrint()}function ri(t){var e=this.paper,n=t.target.value,r=Qr[n];e.w=ei(r[1]),e.h=ei(r[2]),this.preview()}function ii(t){var e=this.paper,n=t.target.value,r=ti[n];e.orientation=r,this.preview()}var oi=function(){return t=function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:ei(Qr[0][1]),h:ei(Qr[0][2]),padding:50,orientation:ti[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=s("div","".concat(ye,"-print")).children(s("div","".concat(ye,"-print-bar")).children(s("div","-title").child("Print settings"),s("div","-right").children(s("div","".concat(ye,"-buttons")).children(new qn("cancel").on("click",ni.bind(this,"cancel")),new qn("next","primary").on("click",ni.bind(this,"next"))))),s("div","".concat(ye,"-print-content")).children(this.contentEl=s("div","-content"),s("div","-sider").child(s("form","").children(s("fieldset","").children(s("label","").child("".concat(St("print.size"))),(n=s("select","")).children.apply(n,Zr(Qr.map((function(t,e){return s("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))})))).on("change",ri.bind(this))),s("fieldset","").children(s("label","").child("".concat(St("print.orientation"))),(r=s("select","")).children.apply(r,Zr(ti.map((function(t,e){return s("option","").attr("value",e).child("".concat(St("print.orientations")[e]))})))).on("change",ii.bind(this))))))).hide()},(e=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,n=this.paper,r=n.width,i=n.height,o=n.padding,a=r-2*o,u=i-2*o,l=e.contentRange(),c=parseInt(l.h/u,10)+1,f=a/l.w,h=o,y=o;f>1&&(h+=(a-l.w)/2);var p=0,v=0;this.contentEl.html(""),this.canvases=[];for(var d={sri:0,sci:0,eri:0,eci:0},b=function(){var n=0,o=0,a=s("div","".concat(ye,"-canvas-card")),c=s("canvas","".concat(ye,"-canvas"));t.canvases.push(c.el);var b=new ir(c.el,r,i);for(b.save(),b.translate(h,y),f<1&&b.scale(f,f);p<=l.eri;p+=1){var m=e.rows.getHeight(p);if(!((n+=m)<u)){o=-(n-m);break}for(var g=0;g<=l.eci;g+=1)Br(b,e,p,g,v),d.eci=g}d.eri=p,b.restore(),b.save(),b.translate(h,y),f<1&&b.scale(f,f);var w=v;e.eachMergesInView(d,(function(t){var n=t.sri,r=t.sci;Br(b,e,n,r,w)})),b.restore(),d.sri=d.eri,d.sci=d.eci,v+=o,t.contentEl.child(s("div","".concat(ye,"-canvas-card-wraper")).child(a.child(c)))},m=0;m<c;m+=1)b();this.el.show()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=s("iframe","").hide().el;window.document.body.appendChild(e);var n=e.contentWindow,r=n.document,i=document.createElement("style");i.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),r.head.appendChild(i),this.canvases.forEach((function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),r.body.appendChild(e)})),n.print()}}])&&Jr(t.prototype,e),n&&Jr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ai(t){return(ai="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ui(t){return function(t){if(Array.isArray(t))return li(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return li(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?li(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function li(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ci(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function si(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fi(r.key),r)}}function fi(t){var e=function(t,e){if("object"!=ai(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ai(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ai(e)?e:e+""}var hi=[{key:"copy",title:Ot("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:Ot("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:Ot("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:Ot("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:Ot("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:Ot("contextmenu.insertRow")},{key:"insert-column",title:Ot("contextmenu.insertColumn")},{key:"vis",title:function(){return""}},{key:"divider"},{key:"delete-row",title:Ot("contextmenu.deleteRow")},{key:"delete-column",title:Ot("contextmenu.deleteColumn")},{key:"delete-cell-text",title:Ot("contextmenu.deleteCellText")},{key:"hide",title:Ot("contextmenu.hide")},{key:"divider"},{key:"validation",title:Ot("contextmenu.validation")},{key:"divider"},{key:"cell-printable",title:Ot("contextmenu.cellprintable")},{key:"cell-non-printable",title:Ot("contextmenu.cellnonprintable")},{key:"divider"},{key:"cell-editable",title:Ot("contextmenu.celleditable")},{key:"cell-non-editable",title:Ot("contextmenu.cellnoneditable")}];function yi(t){var e=this;return"divider"===t.key?s("div","".concat(ye,"-item divider")):s("div","".concat(ye,"-item")).on("click",(function(){e.itemClick(t.key),e.hide()})).children(t.title(),s("div","label").child(t.label||""))}function pi(){var t=this;return hi.map((function(e){return yi.call(t,e)}))}var vi=function(){return t=function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ci(this,t),this.menuItems=pi.call(this),this.el=(n=s("div","".concat(ye,"-contextmenu"))).children.apply(n,ui(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=r,this.setMode("range")},(e=[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),le(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var n=this.el,r=n.show().offset().width,i=this.viewFn(),o=i.height/2,a=t;i.width-t<=r&&(a-=r),n.css("left","".concat(a,"px")),e>o?n.css("bottom","".concat(i.height-e,"px")).css("max-height","".concat(e,"px")).css("top","auto"):n.css("top","".concat(e,"px")).css("max-height","".concat(i.height-e,"px")).css("bottom","auto"),ce(n)}}}])&&si(t.prototype,e),n&&si(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mi(r.key),r)}}function mi(t){var e=function(t,e){if("object"!=di(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=di(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==di(e)?e:e+""}var gi=function(){return t=function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip="",e&&(this.tip=St("toolbar.".concat(e.replace(/-[a-z]/g,(function(t){return t[1].toUpperCase()}))))),n&&(this.tip+=" (".concat(n,")")),this.tag=e,this.shortcut=n,this.value=r,this.el=this.element(),this.change=function(){}},(e=[{key:"element",value:function(){var t=this,e=this.tip;return s("div","".concat(ye,"-toolbar-btn")).on("mouseenter",(function(e){t.tip&&function(t,e){if(!e.classList.contains("active")){var n=e.getBoundingClientRect(),r=n.left,i=n.top,o=n.width,a=n.height,u=s("div","".concat(ye,"-tooltip")).html(t).show();document.body.appendChild(u.el);var l=u.box();u.css("left","".concat(r+o/2-l.width/2,"px")).css("top","".concat(i+a+2,"px")),ae(e,"mouseleave",(function(){document.body.contains(u.el)&&document.body.removeChild(u.el)})),ae(e,"click",(function(){document.body.contains(u.el)&&document.body.removeChild(u.el)}))}}(t.tip,e.target)})).attr("data-tooltip",e)}},{key:"setState",value:function(){}}])&&bi(t.prototype,e),n&&bi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function wi(t){return(wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Si(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ki(r.key),r)}}function ki(t){var e=function(t,e){if("object"!=wi(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=wi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wi(e)?e:e+""}function ji(t,e,n){return e=Pi(e),function(t,e){if(e&&("object"==wi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Pi(t).constructor):e.apply(t,n))}function _i(){return(_i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=xi(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function xi(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=Pi(t)););return t}function Pi(t){return(Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ei(t,e){return(Ei=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ai=function(t){function e(){return Si(this,e),ji(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ei(t,e)}(e,t),function(t,e,n){return e&&Oi(t.prototype,e),n&&Oi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t,n,r,i,o,a=this,u=this.tag;return this.dd=this.dropdown(),this.dd.change=function(t){return a.change(u,a.getValue(t))},(t=e,n="element",r=this,i=3,o=_i(Pi(1&i?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([]).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])}(gi);function Ti(t){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ci(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ri(r.key),r)}}function Ri(t){var e=function(t,e){if("object"!=Ti(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ti(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ti(e)?e:e+""}function Ni(t,e,n){return e=Ii(e),function(t,e){if(e&&("object"==Ti(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Ii(t).constructor):e.apply(t,n))}function Ii(t){return(Ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Di(t,e){return(Di=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var $i=function(t){function e(t,n,r,i){var o,a;Ci(this,e),(a=Ni(this,e,["div","".concat(ye,"-dropdown ").concat(i)])).title=t,a.change=function(){},a.headerClick=function(){},"string"==typeof t?a.title=s("div","".concat(ye,"-dropdown-title")).child(t):r&&a.title.addClass("arrow-left"),a.contentEl=s("div","".concat(ye,"-dropdown-content")).css("width",n).hide();for(var u=arguments.length,l=new Array(u>4?u-4:0),c=4;c<u;c++)l[c-4]=arguments[c];return(o=a).setContentChildren.apply(o,l),a.headerEl=s("div","".concat(ye,"-dropdown-header")),a.headerEl.on("click",(function(){"block"!==a.contentEl.css("display")?a.show():a.hide()})).children(a.title,r?s("div","".concat(ye,"-icon arrow-right")).child(s("div","".concat(ye,"-icon-img arrow-down"))):""),a.children(a.headerEl,a.contentEl),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Di(t,e)}(e,t),n=e,(r=[{key:"setContentChildren",value:function(){var t;this.contentEl.html(""),arguments.length>0&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),ce(this.parent(),(function(){t.hide()}))}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),le(this.parent())}}])&&Mi(n.prototype,r),i&&Mi(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(c);function zi(t){return(zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bi(t){return function(t){if(Array.isArray(t))return Hi(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Hi(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hi(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Fi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qi(r.key),r)}}function qi(t){var e=function(t,e){if("object"!=zi(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=zi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==zi(e)?e:e+""}function Vi(t,e,n){return e=Wi(e),function(t,e){if(e&&("object"==zi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Wi(t).constructor):e.apply(t,n))}function Wi(t){return(Wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ui(t,e){return(Ui=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Li=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new ln("align-".concat(n)),o=t.map((function(t){return(e="align-".concat(t),s("div","".concat(ye,"-item")).child(new ln(e))).on("click",(function(){r.setTitle(t),r.change(t)}));var e}));return r=Vi(this,e,[i,"auto",!0,"bottom-left"].concat(Bi(o)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ui(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&Fi(n.prototype,r),i&&Fi(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}($i);function Xi(t){return(Xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Zi(r.key),r)}}function Zi(t){var e=function(t,e){if("object"!=Xi(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Xi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Xi(e)?e:e+""}function Ki(t,e,n){return e=Ji(e),function(t,e){if(e&&("object"==Xi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Ji(t).constructor):e.apply(t,n))}function Ji(t){return(Ji=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gi(t,e){return(Gi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Qi=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ki(this,e,["align","",t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gi(t,e)}(e,t),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new Li(["left","center","right"],t)}}])&&Yi(n.prototype,r),i&&Yi(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ai);function to(t){return(to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,no(r.key),r)}}function no(t){var e=function(t,e){if("object"!=to(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=to(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==to(e)?e:e+""}function ro(t,e,n){return e=io(e),function(t,e){if(e&&("object"==to(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],io(t).constructor):e.apply(t,n))}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oo(t,e){return(oo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var ao=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ro(this,e,["valign","",t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oo(t,e)}(e,t),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new Li(["top","middle","bottom"],t)}}])&&eo(n.prototype,r),i&&eo(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ai);function uo(t){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function co(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,so(r.key),r)}}function so(t){var e=function(t,e){if("object"!=uo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=uo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==uo(e)?e:e+""}function fo(t,e,n){return e=po(e),function(t,e){if(e&&("object"==uo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],po(t).constructor):e.apply(t,n))}function ho(){return(ho="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=yo(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function yo(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=po(t)););return t}function po(t){return(po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vo(t,e){return(vo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var bo=function(t){function e(){return lo(this,e),fo(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vo(t,e)}(e,t),function(t,e,n){return e&&co(t.prototype,e),n&&co(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"element",value:function(){var t,n,r,i,o,a=this,u=this.tag;return(t=e,n="element",r=this,i=3,o=ho(po(1&i?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([]).child(new ln(u)).on("click",(function(){return a.click()}))}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])}(gi);function mo(t){return(mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function go(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wo(r.key),r)}}function wo(t){var e=function(t,e){if("object"!=mo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=mo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==mo(e)?e:e+""}function So(t,e,n){return e=Oo(e),function(t,e){if(e&&("object"==mo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Oo(t).constructor):e.apply(t,n))}function Oo(t){return(Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ko(t,e){return(ko=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var jo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),So(this,e,["autofilter"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ko(t,e)}(e,t),n=e,(r=[{key:"setState",value:function(){}}])&&go(n.prototype,r),i&&go(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(bo);function _o(t){return(_o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Po(r.key),r)}}function Po(t){var e=function(t,e){if("object"!=_o(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=_o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==_o(e)?e:e+""}function Eo(t,e,n){return e=Ao(e),function(t,e){if(e&&("object"==_o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Ao(t).constructor):e.apply(t,n))}function Ao(t){return(Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function To(t,e){return(To=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Co=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Eo(this,e,["font-bold","Ctrl+B"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&To(t,e)}(e,t),n=e,r&&xo(n.prototype,r),i&&xo(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(bo);function Mo(t){return(Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ro(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,No(r.key),r)}}function No(t){var e=function(t,e){if("object"!=Mo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Mo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Mo(e)?e:e+""}function Io(t,e,n){return e=Do(e),function(t,e){if(e&&("object"==Mo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Do(t).constructor):e.apply(t,n))}function Do(t){return(Do=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $o(t,e){return($o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var zo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Io(this,e,["font-italic","Ctrl+I"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$o(t,e)}(e,t),n=e,r&&Ro(n.prototype,r),i&&Ro(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(bo);function Bo(t){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ho(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fo(r.key),r)}}function Fo(t){var e=function(t,e){if("object"!=Bo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Bo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Bo(e)?e:e+""}function qo(t,e,n){return e=Vo(e),function(t,e){if(e&&("object"==Bo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Vo(t).constructor):e.apply(t,n))}function Vo(t){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wo(t,e){return(Wo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Uo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),qo(this,e,["strike","Ctrl+U"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wo(t,e)}(e,t),n=e,r&&Ho(n.prototype,r),i&&Ho(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(bo);function Lo(t){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Yo(r.key),r)}}function Yo(t){var e=function(t,e){if("object"!=Lo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Lo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Lo(e)?e:e+""}function Zo(t,e,n){return e=Ko(e),function(t,e){if(e&&("object"==Lo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Ko(t).constructor):e.apply(t,n))}function Ko(t){return(Ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jo(t,e){return(Jo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Go=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Zo(this,e,["underline","Ctrl+U"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jo(t,e)}(e,t),n=e,r&&Xo(n.prototype,r),i&&Xo(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(bo);function Qo(t){return(Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ta(t){return function(t){if(Array.isArray(t))return ea(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ea(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ea(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ea(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function na(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ia(r.key),r)}}function ra(t,e,n){return e&&na(t.prototype,e),n&&na(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ia(t){var e=function(t,e){if("object"!=Qo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Qo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Qo(e)?e:e+""}var oa=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],aa=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],ua=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function la(t){var e=this;return s("td","").child(s("div","".concat(ye,"-color-palette-cell")).on("click.stop",(function(){return e.change(t)})).css("background-color",t))}var ca=ra((function t(){var e,n,r,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=s("div","".concat(ye,"-color-palette")),this.change=function(){};var o=s("table","").children((e=s("tbody","")).children.apply(e,[(n=s("tr","".concat(ye,"-theme-color-placeholders"))).children.apply(n,ta(oa.map((function(t){return la.call(i,t)}))))].concat(ta(aa.map((function(t){var e;return(e=s("tr","".concat(ye,"-theme-colors"))).children.apply(e,ta(t.map((function(t){return la.call(i,t)}))))}))),[(r=s("tr","".concat(ye,"-standard-colors"))).children.apply(r,ta(ua.map((function(t){return la.call(i,t)}))))])));this.el.child(o)}));function sa(t){return(sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ha(r.key),r)}}function ha(t){var e=function(t,e){if("object"!=sa(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=sa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==sa(e)?e:e+""}function ya(t,e,n){return e=pa(e),function(t,e){if(e&&("object"==sa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],pa(t).constructor):e.apply(t,n))}function pa(t){return(pa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function va(t,e){return(va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var da=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new ln(t).css("height","16px").css("border-bottom","3px solid ".concat(n)),o=new ca;return o.change=function(t){r.setTitle(t),r.change(t)},r=ya(this,e,[i,"auto",!1,"bottom-left",o.el])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&va(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&fa(n.prototype,r),i&&fa(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}($i);function ba(t){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ma(t){return function(t){if(Array.isArray(t))return ga(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ga(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ga(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ga(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function wa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Sa(r.key),r)}}function Sa(t){var e=function(t,e){if("object"!=ba(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ba(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ba(e)?e:e+""}function Oa(t,e,n){return e=ka(e),function(t,e){if(e&&("object"==ba(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ka(t).constructor):e.apply(t,n))}function ka(t){return(ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ja(t,e){return(ja=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var _a=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],xa=function(t){function e(t){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=new ln("line-type"),i=0,o=_a.map((function(e,r){return s("div","".concat(ye,"-item state ").concat(t===e[0]?"checked":"")).on("click",(function(){o[i].toggle("checked"),o[r].toggle("checked"),i=r,n.hide(),n.change(e)})).child(s("div","".concat(ye,"-line-type")).html(e[1]))}));return n=Oa(this,e,[r,"auto",!1,"bottom-left"].concat(ma(o)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ja(t,e)}(e,t),n=e,r&&wa(n.prototype,r),i&&wa(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}($i);function Pa(t){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ea(t){return function(t){if(Array.isArray(t))return Ca(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ta(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Aa(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||Ta(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ta(t,e){if(t){if("string"==typeof t)return Ca(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ca(t,e):void 0}}function Ca(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ma(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Na(r.key),r)}}function Ra(t,e,n){return e&&Ma(t.prototype,e),n&&Ma(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Na(t){var e=function(t,e){if("object"!=Pa(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Pa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Pa(e)?e:e+""}function Ia(){var t;return s("table","").child((t=s("tbody","")).children.apply(t,arguments))}function Da(t){var e=this;return s("td","").child(s("div","".concat(ye,"-border-palette-cell")).child(new ln("border-".concat(t))).on("click",(function(){e.mode=t;var n=e.mode,r=e.style,i=e.color;e.change({mode:n,style:r,color:i})})))}var $a=Ra((function t(){var e,n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new da("line-color",this.color),this.ddColor.change=function(t){r.color=t},this.ddType=new xa(this.style),this.ddType.change=function(t){var e=Aa(t,1)[0];r.style=e},this.el=s("div","".concat(ye,"-border-palette"));var i=Ia(s("tr","").children(s("td","".concat(ye,"-border-palette-left")).child(Ia((e=s("tr","")).children.apply(e,Ea(["all","inside","horizontal","vertical","outside"].map((function(t){return Da.call(r,t)})))),(n=s("tr","")).children.apply(n,Ea(["left","top","right","bottom","none"].map((function(t){return Da.call(r,t)})))))),s("td","".concat(ye,"-border-palette-right")).children(s("div","".concat(ye,"-toolbar-btn")).child(this.ddColor.el),s("div","".concat(ye,"-toolbar-btn")).child(this.ddType.el))));this.el.child(i)}));function za(t){return(za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ba(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ha(r.key),r)}}function Ha(t){var e=function(t,e){if("object"!=za(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=za(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==za(e)?e:e+""}function Fa(t,e,n){return e=qa(e),function(t,e){if(e&&("object"==za(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],qa(t).constructor):e.apply(t,n))}function qa(t){return(qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Va(t,e){return(Va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Wa=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new ln("border-all"),r=new $a;return r.change=function(e){t.change(e),t.hide()},t=Fa(this,e,[n,"auto",!1,"bottom-left",r.el])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Va(t,e)}(e,t),n=e,r&&Ba(n.prototype,r),i&&Ba(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}($i);function Ua(t){return(Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function La(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xa(r.key),r)}}function Xa(t){var e=function(t,e){if("object"!=Ua(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ua(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ua(e)?e:e+""}function Ya(t,e,n){return e=Za(e),function(t,e){if(e&&("object"==Ua(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Za(t).constructor):e.apply(t,n))}function Za(t){return(Za=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ka(t,e){return(Ka=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ja=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ya(this,e,["border"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ka(t,e)}(e,t),n=e,(r=[{key:"dropdown",value:function(){return new Wa}}])&&La(n.prototype,r),i&&La(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ai);function Ga(t){return(Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,eu(r.key),r)}}function eu(t){var e=function(t,e){if("object"!=Ga(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ga(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ga(e)?e:e+""}function nu(t,e,n){return e=ou(e),function(t,e){if(e&&("object"==Ga(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],ou(t).constructor):e.apply(t,n))}function ru(){return(ru="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=iu(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}}).apply(null,arguments)}function iu(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=ou(t)););return t}function ou(t){return(ou=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function au(t,e){return(au=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var uu=function(t){function e(){return Qa(this,e),nu(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&au(t,e)}(e,t),function(t,e,n){return e&&tu(t.prototype,e),n&&tu(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(e,[{key:"element",value:function(){var t,n,r,i,o,a=this;return(t=e,n="element",r=this,i=3,o=ru(ou(1&i?t.prototype:t),n,r),2&i&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([]).child(new ln(this.tag)).on("click",(function(){return a.change(a.tag)}))}},{key:"setState",value:function(t){this.el.disabled(t)}}])}(gi);function lu(t){return(lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,su(r.key),r)}}function su(t){var e=function(t,e){if("object"!=lu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=lu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==lu(e)?e:e+""}function fu(t,e,n){return e=hu(e),function(t,e){if(e&&("object"==lu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],hu(t).constructor):e.apply(t,n))}function hu(t){return(hu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yu(t,e){return(yu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var pu=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),fu(this,e,["clearformat"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yu(t,e)}(e,t),n=e,r&&cu(n.prototype,r),i&&cu(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(uu);function vu(t){return(vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function du(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bu(r.key),r)}}function bu(t){var e=function(t,e){if("object"!=vu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=vu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==vu(e)?e:e+""}function mu(t,e,n){return e=gu(e),function(t,e){if(e&&("object"==vu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],gu(t).constructor):e.apply(t,n))}function gu(t){return(gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wu(t,e){return(wu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Su=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),mu(this,e,["paintformat"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wu(t,e)}(e,t),n=e,(r=[{key:"setState",value:function(){}}])&&du(n.prototype,r),i&&du(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(bo);function Ou(t){return(Ou="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ku(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ju(r.key),r)}}function ju(t){var e=function(t,e){if("object"!=Ou(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ou(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ou(e)?e:e+""}function _u(t,e,n){return e=xu(e),function(t,e){if(e&&("object"==Ou(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],xu(t).constructor):e.apply(t,n))}function xu(t){return(xu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pu(t,e){return(Pu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Eu=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),_u(this,e,["color",void 0,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pu(t,e)}(e,t),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new da(t,e)}}])&&ku(n.prototype,r),i&&ku(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ai);function Au(t){return(Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cu(r.key),r)}}function Cu(t){var e=function(t,e){if("object"!=Au(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Au(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Au(e)?e:e+""}function Mu(t,e,n){return e=Ru(e),function(t,e){if(e&&("object"==Au(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Ru(t).constructor):e.apply(t,n))}function Ru(t){return(Ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nu(t,e){return(Nu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Iu=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Mu(this,e,["bgcolor",void 0,t])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nu(t,e)}(e,t),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new da(t,e)}}])&&Tu(n.prototype,r),i&&Tu(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ai);function Du(t){return(Du="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $u(t){return function(t){if(Array.isArray(t))return zu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return zu(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zu(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Bu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hu(r.key),r)}}function Hu(t){var e=function(t,e){if("object"!=Du(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Du(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Du(e)?e:e+""}function Fu(t,e,n){return e=qu(e),function(t,e){if(e&&("object"==Du(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],qu(t).constructor):e.apply(t,n))}function qu(t){return(qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Vu(t,e){return(Vu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Wu=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=ar.map((function(e){return s("div","".concat(ye,"-item")).on("click",(function(){t.setTitle("".concat(e.pt)),t.change(e)})).child("".concat(e.pt))}));return t=Fu(this,e,["10","60px",!0,"bottom-left"].concat($u(n)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vu(t,e)}(e,t),n=e,r&&Bu(n.prototype,r),i&&Bu(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}($i);function Uu(t){return(Uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xu(r.key),r)}}function Xu(t){var e=function(t,e){if("object"!=Uu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Uu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Uu(e)?e:e+""}function Yu(t,e,n){return e=Zu(e),function(t,e){if(e&&("object"==Uu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Zu(t).constructor):e.apply(t,n))}function Zu(t){return(Zu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ku(t,e){return(Ku=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ju=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Yu(this,e,["font-size"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ku(t,e)}(e,t),n=e,(r=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new Wu}}])&&Lu(n.prototype,r),i&&Lu(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ai);function Gu(t){return(Gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qu(t){return function(t){if(Array.isArray(t))return tl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return tl(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tl(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function el(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,nl(r.key),r)}}function nl(t){var e=function(t,e){if("object"!=Gu(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Gu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Gu(e)?e:e+""}function rl(t,e,n){return e=il(e),function(t,e){if(e&&("object"==Gu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],il(t).constructor):e.apply(t,n))}function il(t){return(il=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ol(t,e){return(ol=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var al=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=or.map((function(e){return s("div","".concat(ye,"-item")).on("click",(function(){t.setTitle(e.title),t.change(e)})).child(e.title)}));return t=rl(this,e,[or[0].title,"160px",!0,"bottom-left"].concat(Qu(n)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ol(t,e)}(e,t),n=e,r&&el(n.prototype,r),i&&el(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}($i);function ul(t){return(ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ll(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cl(r.key),r)}}function cl(t){var e=function(t,e){if("object"!=ul(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ul(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ul(e)?e:e+""}function sl(t,e,n){return e=fl(e),function(t,e){if(e&&("object"==ul(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],fl(t).constructor):e.apply(t,n))}function fl(t){return(fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hl(t,e){return(hl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var yl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),sl(this,e,["font-name"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hl(t,e)}(e,t),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new al}}])&&ll(n.prototype,r),i&&ll(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ai);function pl(t){return(pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vl(t){return function(t){if(Array.isArray(t))return dl(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return dl(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dl(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dl(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function bl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ml(r.key),r)}}function ml(t){var e=function(t,e){if("object"!=pl(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=pl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==pl(e)?e:e+""}function gl(t,e,n){return e=wl(e),function(t,e){if(e&&("object"==pl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],wl(t).constructor):e.apply(t,n))}function wl(t){return(wl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sl(t,e){return(Sl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ol=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=Ar.slice(0);return n.splice(2,0,{key:"divider"}),n.splice(8,0,{key:"divider"}),n=n.map((function(e){var n=s("div","".concat(ye,"-item"));return"divider"===e.key?n.addClass("divider"):(n.child(e.title()).on("click",(function(){t.setTitle(e.title()),t.change(e)})),e.label&&n.child(s("div","label").html(e.label))),n})),t=gl(this,e,["Normal","220px",!0,"bottom-left"].concat(vl(n)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sl(t,e)}(e,t),n=e,(r=[{key:"setTitle",value:function(t){for(var e=0;e<Ar.length;e+=1)Ar[e].key===t&&this.title.html(Ar[e].title());this.hide()}}])&&bl(n.prototype,r),i&&bl(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}($i);function kl(t){return(kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_l(r.key),r)}}function _l(t){var e=function(t,e){if("object"!=kl(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=kl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==kl(e)?e:e+""}function xl(t,e,n){return e=Pl(e),function(t,e){if(e&&("object"==kl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Pl(t).constructor):e.apply(t,n))}function Pl(t){return(Pl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function El(t,e){return(El=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Al=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),xl(this,e,["format"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&El(t,e)}(e,t),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Ol}}])&&jl(n.prototype,r),i&&jl(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ai);function Tl(t){return(Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cl(t){return function(t){if(Array.isArray(t))return Ml(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ml(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ml(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ml(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Rl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Nl(r.key),r)}}function Nl(t){var e=function(t,e){if("object"!=Tl(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Tl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Tl(e)?e:e+""}function Il(t,e,n){return e=Dl(e),function(t,e){if(e&&("object"==Tl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Dl(t).constructor):e.apply(t,n))}function Dl(t){return(Dl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $l(t,e){return($l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var zl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=gr.map((function(e){return s("div","".concat(ye,"-item")).on("click",(function(){t.hide(),t.change(e)})).child(e.key)}));return t=Il(this,e,[new ln("formula"),"180px",!0,"bottom-left"].concat(Cl(n)))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$l(t,e)}(e,t),n=e,r&&Rl(n.prototype,r),i&&Rl(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}($i);function Bl(t){return(Bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fl(r.key),r)}}function Fl(t){var e=function(t,e){if("object"!=Bl(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Bl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Bl(e)?e:e+""}function ql(t,e,n){return e=Vl(e),function(t,e){if(e&&("object"==Bl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Vl(t).constructor):e.apply(t,n))}function Vl(t){return(Vl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wl(t,e){return(Wl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Ul=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ql(this,e,["formula"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wl(t,e)}(e,t),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new zl}}])&&Hl(n.prototype,r),i&&Hl(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(Ai);function Ll(t){return(Ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Yl(r.key),r)}}function Yl(t){var e=function(t,e){if("object"!=Ll(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ll(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ll(e)?e:e+""}function Zl(t,e,n){return e=Kl(e),function(t,e){if(e&&("object"==Ll(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Kl(t).constructor):e.apply(t,n))}function Kl(t){return(Kl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Jl(t,e){return(Jl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Gl=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Zl(this,e,["freeze"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jl(t,e)}(e,t),n=e,r&&Xl(n.prototype,r),i&&Xl(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(bo);function Ql(t){return(Ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ec(r.key),r)}}function ec(t){var e=function(t,e){if("object"!=Ql(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ql(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ql(e)?e:e+""}function nc(t,e,n){return e=rc(e),function(t,e){if(e&&("object"==Ql(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],rc(t).constructor):e.apply(t,n))}function rc(t){return(rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ic(t,e){return(ic=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var oc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),nc(this,e,["merge"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ic(t,e)}(e,t),n=e,(r=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&tc(n.prototype,r),i&&tc(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(bo);function ac(t){return(ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lc(r.key),r)}}function lc(t){var e=function(t,e){if("object"!=ac(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ac(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ac(e)?e:e+""}function cc(t,e,n){return e=sc(e),function(t,e){if(e&&("object"==ac(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],sc(t).constructor):e.apply(t,n))}function sc(t){return(sc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fc(t,e){return(fc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var hc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),cc(this,e,["redo","Ctrl+Y"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fc(t,e)}(e,t),n=e,r&&uc(n.prototype,r),i&&uc(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(uu);function yc(t){return(yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vc(r.key),r)}}function vc(t){var e=function(t,e){if("object"!=yc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=yc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==yc(e)?e:e+""}function dc(t,e,n){return e=bc(e),function(t,e){if(e&&("object"==yc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],bc(t).constructor):e.apply(t,n))}function bc(t){return(bc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mc(t,e){return(mc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var gc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),dc(this,e,["undo","Ctrl+Z"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mc(t,e)}(e,t),n=e,r&&pc(n.prototype,r),i&&pc(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(uu);function wc(t){return(wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Oc(r.key),r)}}function Oc(t){var e=function(t,e){if("object"!=wc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=wc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==wc(e)?e:e+""}function kc(t,e,n){return e=jc(e),function(t,e){if(e&&("object"==wc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],jc(t).constructor):e.apply(t,n))}function jc(t){return(jc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _c(t,e){return(_c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var xc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),kc(this,e,["print","Ctrl+P"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_c(t,e)}(e,t),n=e,r&&Sc(n.prototype,r),i&&Sc(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(uu);function Pc(t){return(Pc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ec(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ac(r.key),r)}}function Ac(t){var e=function(t,e){if("object"!=Pc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Pc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Pc(e)?e:e+""}function Tc(t,e,n){return e=Cc(e),function(t,e){if(e&&("object"==Pc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Cc(t).constructor):e.apply(t,n))}function Cc(t){return(Cc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mc(t,e){return(Mc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Rc=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Tc(this,e,["textwrap"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mc(t,e)}(e,t),n=e,r&&Ec(n.prototype,r),i&&Ec(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(bo);function Nc(t){return(Nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ic(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$c(r.key),r)}}function Dc(t,e,n){return e&&Ic(t.prototype,e),n&&Ic(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function $c(t){var e=function(t,e){if("object"!=Nc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Nc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Nc(e)?e:e+""}function zc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bc(t,e,n){return e=Hc(e),function(t,e){if(e&&("object"==Nc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Hc(t).constructor):e.apply(t,n))}function Hc(t){return(Hc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qc(t,e)}function qc(t,e){return(qc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var Vc=function(t){function e(){var t;zc(this,e);var n=new ln("ellipsis"),r=s("div","".concat(ye,"-toolbar-more"));return(t=Bc(this,e,[n,"auto",!1,"bottom-right",r])).moreBtns=r,t.contentEl.css("max-width","420px"),t}return Fc(e,t),Dc(e)}($i),Wc=function(t){function e(){var t;return zc(this,e),(t=Bc(this,e,["more"])).el.hide(),t}return Fc(e,t),Dc(e,[{key:"dropdown",value:function(){return new Vc}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])}(Ai);function Uc(t){return(Uc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lc(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Yc(r.key),r)}}function Yc(t){var e=function(t,e){if("object"!=Uc(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Uc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Uc(e)?e:e+""}function Zc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Kc(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kc(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Jc(){return s("div","".concat(ye,"-toolbar-divider"))}function Gc(){var t=this;this.btns2=[],this.items.forEach((function(e){if(Array.isArray(e))e.forEach((function(e){var n=e.el,r=n.box(),i=n.computedStyle(),o=i.marginLeft,a=i.marginRight;t.btns2.push([n,r.width+parseInt(o,10)+parseInt(a,10)])}));else{var n=e.box(),r=e.computedStyle(),i=r.marginLeft,o=r.marginRight;t.btns2.push([e,n.width+parseInt(i,10)+parseInt(o,10)])}}))}function Qc(){var t,e,n=this.el,r=this.btns,i=this.moreEl,o=this.btns2,a=i.dd,u=a.moreBtns,l=a.contentEl;n.css("width","".concat(this.widthFn(),"px"));var c=n.box(),s=160,f=12,h=[],y=[];o.forEach((function(t,e){var n=Zc(t,2),r=n[0],i=n[1];s+=i,e===o.length-1||s<c.width?h.push(r):(f+=i,y.push(r))})),(t=r.html("")).children.apply(t,h),(e=u.html("")).children.apply(e,y),l.css("width","".concat(f,"px")),y.length>0?i.show():i.hide()}function ts(t){var e=this,n=new gi;n.el.on("click",(function(){t.onClick&&t.onClick(e.data.getData(),e.data)})),n.tip=t.tip||"";var r=t.el;if(t.icon&&(r=s("img").attr("src",t.icon)),r){var i=s("div","".concat(ye,"-icon"));i.child(r),n.el.child(i)}return n}var es=function(){return t=function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Lc(this,t),this.data=e,this.change=function(){},this.widthFn=n,this.isHide=i;var o=e.defaultStyle();this.items=[[this.undoEl=new gc,this.redoEl=new hc,new xc,this.paintformatEl=new Su,this.clearformatEl=new pu],Jc(),[this.formatEl=new Al],Jc(),[this.fontEl=new yl,this.fontSizeEl=new Ju],Jc(),[this.boldEl=new Co,this.italicEl=new zo,this.underlineEl=new Go,this.strikeEl=new Uo,this.textColorEl=new Eu(o.color)],Jc(),[this.fillColorEl=new Iu(o.bgcolor),this.borderEl=new Ja,this.mergeEl=new oc],Jc(),[this.alignEl=new Qi(o.align),this.valignEl=new ao(o.valign),this.textwrapEl=new Rc],Jc(),[this.freezeEl=new Gl,this.autofilterEl=new jo,this.formulaEl=new Ul]];var a=e.settings.extendToolbar,u=void 0===a?{}:a;if(u.left&&u.left.length>0){this.items.unshift(Jc());var l=u.left.map(ts.bind(this));this.items.unshift(l)}if(u.right&&u.right.length>0){this.items.push(Jc());var c=u.right.map(ts.bind(this));this.items.push(c)}this.items.push([this.moreEl=new Wc]),this.el=s("div","".concat(ye,"-toolbar")),this.btns=s("div","".concat(ye,"-toolbar-btns")),this.items.forEach((function(t){Array.isArray(t)?t.forEach((function(t){r.btns.child(t.el),t.change=function(){r.change.apply(r,arguments)}})):r.btns.child(t.el)})),this.el.child(this.btns),i?this.el.hide():(this.reset(),setTimeout((function(){Gc.call(r),Qc.call(r)}),0),ae(window,"resize",(function(){Qc.call(r)})))},(e=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.undoEl.setState(!t.canUndo()),this.redoEl.setState(!t.canRedo()),this.mergeEl.setState(t.canUnmerge(),!t.selector.multiple()),this.autofilterEl.setState(!t.canAutofilter());var n=e.font,r=e.format;this.formatEl.setState(r),this.fontEl.setState(n.name),this.fontSizeEl.setState(n.size),this.boldEl.setState(n.bold),this.italicEl.setState(n.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&Xc(t.prototype,e),n&&Xc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ns(t){return(ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rs(t){return function(t){if(Array.isArray(t))return is(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return is(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?is(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function is(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function os(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function as(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,us(r.key),r)}}function us(t){var e=function(t,e){if("object"!=ns(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ns(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ns(e)?e:e+""}var ls=function(){return t=function t(e,n){var r,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px";os(this,t),this.title=e,this.el=s("div","".concat(ye,"-modal")).css("width",o).children(s("div","".concat(ye,"-modal-header")).children(new ln("close").on("click.stop",(function(){return i.hide()})),this.title),(r=s("div","".concat(ye,"-modal-content"))).children.apply(r,rs(n))).hide()},(e=[{key:"show",value:function(){var t=this;this.dimmer=s("div","".concat(ye,"-dimmer active")),document.body.appendChild(this.dimmer.el);var e=this.el.show().box(),n=e.width,r=e.height,i=document.documentElement,o=i.clientHeight,a=i.clientWidth;this.el.offset({left:(a-n)/2,top:(o-r)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},ae(window,"keydown",window.xkeydownEsc)}},{key:"hide",value:function(){this.el.hide(),document.body.removeChild(this.dimmer.el),ue(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}}])&&as(t.prototype,e),n&&as(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function cs(t){return(cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ss(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fs(r.key),r)}}function fs(t){var e=function(t,e){if("object"!=cs(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=cs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==cs(e)?e:e+""}var hs=function(){return t=function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=s("div","".concat(ye,"-form-input")),this.input=s("input","").css("width",e).on("input",(function(t){return r.vchange(t)})).attr("placeholder",n),this.el.child(this.input)},(e=[{key:"focus",value:function(){var t=this;setTimeout((function(){t.input.el.focus()}),10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&ss(t.prototype,e),n&&ss(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ys(t){return(ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ps(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ds(r.key),r)}}function ds(t){var e=function(t,e){if("object"!=ys(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ys(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ys(e)?e:e+""}var bs=function(){return t=function t(e,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};ps(this,t),this.key=e,this.getTitle=o,this.vchange=function(){},this.el=s("div","".concat(ye,"-form-select")),this.suggest=new tn(n.map((function(t){return{key:t,title:i.getTitle(t)}})),(function(t){i.itemClick(t.key),a(t.key),i.vchange(t.key)}),r,this.el),this.el.children(this.itemEl=s("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",(function(){return i.show()}))},(e=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&vs(t.prototype,e),n&&vs(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ms(t){return(ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ws(r.key),r)}}function ws(t){var e=function(t,e){if("object"!=ms(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ms(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ms(e)?e:e+""}var Ss={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},Os=function(){return t=function t(e,n,r,i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=n,r&&(this.label=s("label","label").css("width","".concat(i,"px")).html(r)),this.tip=s("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return o.validate()},this.el=s("div","".concat(ye,"-form-field")).children(this.label,e.el,this.tip)},(e=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,n=this.tip,r=this.el,i=t.val();return e.required&&/^\s*$/.test(i)?(n.html(St("validation.required")),r.addClass("error"),!1):!e.type&&!e.pattern||(e.pattern||Ss[e.type]).test(i)?(r.removeClass("error"),!0):(n.html(St("validation.notMatch")),r.addClass("error"),!1)}}])&&gs(t.prototype,e),n&&gs(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ks(t){return(ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function js(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_s(r.key),r)}}function _s(t){var e=function(t,e){if("object"!=ks(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ks(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ks(e)?e:e+""}function xs(t,e,n){return e=Ps(e),function(t,e){if(e&&("object"==ks(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],Ps(t).constructor):e.apply(t,n))}function Ps(t){return(Ps=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Es(t,e){return(Es=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var As=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new Os(new bs("cell",["cell"],"100%",(function(t){return St("dataValidation.modeType.".concat(t))})),{required:!0},"".concat(St("dataValidation.range"),":"),100),r=new Os(new hs("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),i=new Os(new bs("list",["list","number","date","phone","email"],"100%",(function(t){return St("dataValidation.type.".concat(t))}),(function(e){return t.criteriaSelected(e)})),{required:!0},"".concat(St("dataValidation.criteria"),":"),100),o=new Os(new bs("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",(function(t){return St("dataValidation.operator.".concat(t))}),(function(e){return t.criteriaOperatorSelected(e)})),{required:!0}).hide(),a=new Os(new hs("70px","10"),{required:!0}).hide(),u=new Os(new hs("70px","100"),{required:!0,type:"number"}).hide(),l=new Os(new hs("120px","a,b,c"),{required:!0}),c=new Os(new hs("70px","10"),{required:!0,type:"number"}).hide();return(t=xs(this,e,[St("contextmenu.validation"),[s("div","".concat(ye,"-form-fields")).children(n.el,r.el),s("div","".concat(ye,"-form-fields")).children(i.el,o.el,a.el,u.el,c.el,l.el),s("div","".concat(ye,"-buttons")).children(new qn("cancel").on("click",(function(){return t.btnClick("cancel")})),new qn("remove").on("click",(function(){return t.btnClick("remove")})),new qn("save","primary").on("click",(function(){return t.btnClick("save")})))]])).mf=n,t.rf=r,t.cf=i,t.of=o,t.minvf=a,t.maxvf=u,t.vf=c,t.svf=l,t.change=function(){},t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Es(t,e)}(e,t),n=e,(r=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",n=this.vf;n.input.hint(e),n.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,n=this.minvf,r=this.maxvf,i=this.vf,o=this.svf;"date"===t||"number"===t?(e.show(),n.rule.type=t,r.rule.type=t,"date"===t?(n.hint("2018-11-12"),r.hint("2019-11-12")):(n.hint("10"),r.hint("100")),n.show(),r.show(),i.hide(),o.hide()):("list"===t?o.show():o.hide(),i.hide(),e.hide(),n.hide(),r.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,n=this.maxvf,r=this.vf;if("be"===t||"nbe"===t)e.show(),n.show(),r.hide();else{var i=this.cf.val();r.rule.type=i,"date"===i?r.hint("2018-11-12"):r.hint("10"),r.show(),e.hide(),n.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],n=0;n<e.length;n+=1){var r=this[e[n]];if(r.isShow()&&!r.validate())return}var i=this.mf.val(),o=this.rf.val(),a=this.cf.val(),u=this.of.val(),l=this.svf.val();"number"!==a&&"date"!==a||(l="be"===u||"nbe"===u?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,o,{type:a,operator:u,required:!1,value:l}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,n=this.rf,r=this.cf,i=this.of,o=this.svf,a=this.vf,u=this.minvf,l=this.maxvf,c=t.mode,s=t.ref,f=t.validator||{type:"list"},h=f.type,y=f.operator,p=f.value;e.val(c||"cell"),n.val(s),r.val(h),i.val(y),Array.isArray(p)?(u.val(p[0]),l.val(p[1])):(o.val(p||""),a.val(p||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(y)}this.show()}}])&&js(n.prototype,r),i&&js(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}(ls);function Ts(t){return(Ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ms(r.key),r)}}function Ms(t){var e=function(t,e){if("object"!=Ts(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Ts(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Ts(e)?e:e+""}function Rs(t){return s("div","".concat(ye,"-item ").concat(t))}function Ns(t){var e=this;return Rs("state").child(St("sort.".concat(t))).on("click.stop",(function(){return e.itemClick(t)}))}function Is(t){var e=this,n=this.filterbEl,r=this.filterValues;n.html(""),Object.keys(t).forEach((function(i,o){var a=t[i],u=r.includes(i)?"checked":"";n.child(s("div","".concat(ye,"-item state ").concat(u)).on("click.stop",(function(){return e.filterClick(o,i)})).children(""===i?St("filter.empty"):i,s("div","label").html("(".concat(a,")"))))}))}function Ds(){var t=this.filterhEl,e=this.filterValues,n=this.values;t.html("".concat(e.length," / ").concat(n.length)),t.checked(e.length===n.length)}var $s=function(){return t=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=s("div","".concat(ye,"-body")),this.filterhEl=s("div","".concat(ye,"-header state")).on("click.stop",(function(){return e.filterClick(0,"all")})),this.el=s("div","".concat(ye,"-sort-filter")).children(this.sortAscEl=Ns.call(this,"asc"),this.sortDescEl=Ns.call(this,"desc"),Rs("divider"),s("div","".concat(ye,"-filter")).children(this.filterhEl,this.filterbEl),s("div","".concat(ye,"-buttons")).children(new qn("cancel").on("click",(function(){return e.btnClick("cancel")})),new qn("ok","primary").on("click",(function(){return e.btnClick("ok")})))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]},(e=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,n=this.sort,r=this.filterValues;this.ok&&this.ok(e,n,"in",r)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,n=this.sortDescEl;e.checked("asc"===t),n.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var n=this.filterbEl,r=this.filterValues,i=this.values,o=n.children();"all"===e?o.length===r.length?(this.filterValues=[],o.forEach((function(t){return s(t).checked(!1)}))):(this.filterValues=Array.from(i),o.forEach((function(t){return s(t).checked(!0)}))):s(o[t]).toggle("checked")?r.push(e):r.splice(r.findIndex((function(t){return t===e})),1),Ds.call(this)}},{key:"set",value:function(t,e,n,r){this.ci=t;var i=this.sortAscEl,o=this.sortDescEl;null!==r?(this.sort=r.order,i.checked(r.asc()),o.checked(r.desc())):(this.sortDesc=null,i.checked(!1),o.checked(!1)),this.values=Object.keys(e),this.filterValues=n?Array.from(n.value):Object.keys(e),Is.call(this,e,n),Ds.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var n=1;ce(this.el,(function(){n<=0&&e.hide(),n-=1}))}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),le(this.el)}}])&&Cs(t.prototype,e),n&&Cs(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function zs(t,e){var n=s("div","".concat(ye,"-toast")),r=s("div","".concat(ye,"-dimmer active"));n.children(s("div","".concat(ye,"-toast-header")).children(new ln("close").on("click.stop",(function(){return document.body.removeChild(n.el),void document.body.removeChild(r.el)})),t),s("div","".concat(ye,"-toast-content")).html(e)),document.body.appendChild(n.el),document.body.appendChild(r.el);var i=n.box(),o=i.width,a=i.height,u=document.documentElement,l=u.clientHeight,c=u.clientWidth;n.offset({left:(c-o)/2,top:(l-a)/3})}function Bs(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}var Hs=function(t){return t};function Fs(t){return"translate("+t+",0)"}function qs(t){return"translate(0,"+t+")"}function Vs(t){return e=>+t(e)}function Ws(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function Us(){return!this.__axis}function Ls(t,e){var n=[],r=null,i=null,o=6,a=6,u=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,c=1===t||4===t?-1:1,s=4===t||2===t?"x":"y",f=1===t||3===t?Fs:qs;function h(h){var y=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,p=null==i?e.tickFormat?e.tickFormat.apply(e,n):Hs:i,v=Math.max(o,0)+u,d=e.range(),b=+d[0]+l,m=+d[d.length-1]+l,g=(e.bandwidth?Ws:Vs)(e.copy(),l),w=h.selection?h.selection():h,S=w.selectAll(".domain").data([null]),O=w.selectAll(".tick").data(y,e).order(),k=O.exit(),j=O.enter().append("g").attr("class","tick"),_=O.select("line"),x=O.select("text");S=S.merge(S.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),O=O.merge(j),_=_.merge(j.append("line").attr("stroke","currentColor").attr(s+"2",c*o)),x=x.merge(j.append("text").attr("fill","currentColor").attr(s,c*v).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),h!==w&&(S=S.transition(h),O=O.transition(h),_=_.transition(h),x=x.transition(h),k=k.transition(h).attr("opacity",1e-6).attr("transform",(function(t){return isFinite(t=g(t))?f(t+l):this.getAttribute("transform")})),j.attr("opacity",1e-6).attr("transform",(function(t){var e=this.parentNode.__axis;return f((e&&isFinite(e=e(t))?e:g(t))+l)}))),k.remove(),S.attr("d",4===t||2===t?a?"M"+c*a+","+b+"H"+l+"V"+m+"H"+c*a:"M"+l+","+b+"V"+m:a?"M"+b+","+c*a+"V"+l+"H"+m+"V"+c*a:"M"+b+","+l+"H"+m),O.attr("opacity",1).attr("transform",(function(t){return f(g(t)+l)})),_.attr(s+"2",c*o),x.attr(s,c*v).text(p),w.filter(Us).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),w.each((function(){this.__axis=g}))}return h.scale=function(t){return arguments.length?(e=t,h):e},h.ticks=function(){return n=Array.from(arguments),h},h.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),h):n.slice()},h.tickValues=function(t){return arguments.length?(r=null==t?null:Array.from(t),h):r&&r.slice()},h.tickFormat=function(t){return arguments.length?(i=t,h):i},h.tickSize=function(t){return arguments.length?(o=a=+t,h):o},h.tickSizeInner=function(t){return arguments.length?(o=+t,h):o},h.tickSizeOuter=function(t){return arguments.length?(a=+t,h):a},h.tickPadding=function(t){return arguments.length?(u=+t,h):u},h.offset=function(t){return arguments.length?(l=+t,h):l},h}function Xs(t){return Ls(3,t)}function Ys(t){return Ls(4,t)}var Zs={value:()=>{}};function Ks(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Js(r)}function Js(t){this._=t}function Gs(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Qs(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function tf(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Zs,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Js.prototype=Ks.prototype={constructor:Js,on:function(t,e){var n,r=this._,i=Gs(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=tf(r[n],t.name,e);else if(null==e)for(n in r)r[n]=tf(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=Qs(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Js(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var ef=Ks;function nf(){}var rf=function(t){return null==t?nf:function(){return this.querySelector(t)}};function of(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function af(){return[]}var uf=function(t){return null==t?af:function(){return this.querySelectorAll(t)}};var lf=function(t){return function(){return this.matches(t)}};function cf(t){return function(e){return e.matches(t)}}var sf=Array.prototype.find;function ff(){return this.firstElementChild}var hf=Array.prototype.filter;function yf(){return Array.from(this.children)}var pf=function(t){return new Array(t.length)};function vf(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}vf.prototype={constructor:vf,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var df=function(t){return function(){return t}};function bf(t,e,n,r,i,o){for(var a,u=0,l=e.length,c=o.length;u<c;++u)(a=e[u])?(a.__data__=o[u],r[u]=a):n[u]=new vf(t,o[u]);for(;u<l;++u)(a=e[u])&&(i[u]=a)}function mf(t,e,n,r,i,o,a){var u,l,c,s=new Map,f=e.length,h=o.length,y=new Array(f);for(u=0;u<f;++u)(l=e[u])&&(y[u]=c=a.call(l,l.__data__,u,e)+"",s.has(c)?i[u]=l:s.set(c,l));for(u=0;u<h;++u)c=a.call(t,o[u],u,o)+"",(l=s.get(c))?(r[u]=l,l.__data__=o[u],s.delete(c)):n[u]=new vf(t,o[u]);for(u=0;u<f;++u)(l=e[u])&&s.get(y[u])===l&&(i[u]=l)}function gf(t){return t.__data__}function wf(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Sf(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var Of="http://www.w3.org/1999/xhtml",kf={svg:"http://www.w3.org/2000/svg",xhtml:Of,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},jf=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),kf.hasOwnProperty(e)?{space:kf[e],local:t}:t};function _f(t){return function(){this.removeAttribute(t)}}function xf(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Pf(t,e){return function(){this.setAttribute(t,e)}}function Ef(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Af(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Tf(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var Cf=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function Mf(t){return function(){this.style.removeProperty(t)}}function Rf(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Nf(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function If(t,e){return t.style.getPropertyValue(e)||Cf(t).getComputedStyle(t,null).getPropertyValue(e)}function Df(t){return function(){delete this[t]}}function $f(t,e){return function(){this[t]=e}}function zf(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Bf(t){return t.trim().split(/^|\s+/)}function Hf(t){return t.classList||new Ff(t)}function Ff(t){this._node=t,this._names=Bf(t.getAttribute("class")||"")}function qf(t,e){for(var n=Hf(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Vf(t,e){for(var n=Hf(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Wf(t){return function(){qf(this,t)}}function Uf(t){return function(){Vf(this,t)}}function Lf(t,e){return function(){(e.apply(this,arguments)?qf:Vf)(this,t)}}Ff.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Xf(){this.textContent=""}function Yf(t){return function(){this.textContent=t}}function Zf(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Kf(){this.innerHTML=""}function Jf(t){return function(){this.innerHTML=t}}function Gf(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Qf(){this.nextSibling&&this.parentNode.appendChild(this)}function th(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function eh(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Of&&e.documentElement.namespaceURI===Of?e.createElement(t):e.createElementNS(n,t)}}function nh(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var rh=function(t){var e=jf(t);return(e.local?nh:eh)(e)};function ih(){return null}function oh(){var t=this.parentNode;t&&t.removeChild(this)}function ah(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function uh(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function lh(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function ch(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function sh(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,u=i.length;a<u;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function fh(t,e,n){var r=Cf(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function hh(t,e){return function(){return fh(this,t,e)}}function yh(t,e){return function(){return fh(this,t,e.apply(this,arguments))}}var ph=[null];function vh(t,e){this._groups=t,this._parents=e}function dh(){return new vh([[document.documentElement]],ph)}vh.prototype=dh.prototype={constructor:vh,select:function(t){"function"!=typeof t&&(t=rf(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,u=e[i],l=u.length,c=r[i]=new Array(l),s=0;s<l;++s)(o=u[s])&&(a=t.call(o,o.__data__,s,u))&&("__data__"in o&&(a.__data__=o.__data__),c[s]=a);return new vh(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return of(t.apply(this,arguments))}}(t):uf(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,u=e[o],l=u.length,c=0;c<l;++c)(a=u[c])&&(r.push(t.call(a,a.__data__,c,u)),i.push(a));return new vh(r,i)},selectChild:function(t){return this.select(null==t?ff:function(t){return function(){return sf.call(this.children,t)}}("function"==typeof t?t:cf(t)))},selectChildren:function(t){return this.selectAll(null==t?yf:function(t){return function(){return hf.call(this.children,t)}}("function"==typeof t?t:cf(t)))},filter:function(t){"function"!=typeof t&&(t=lf(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],u=a.length,l=r[i]=[],c=0;c<u;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&l.push(o);return new vh(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,gf);var n=e?mf:bf,r=this._parents,i=this._groups;"function"!=typeof t&&(t=df(t));for(var o=i.length,a=new Array(o),u=new Array(o),l=new Array(o),c=0;c<o;++c){var s=r[c],f=i[c],h=f.length,y=wf(t.call(s,s&&s.__data__,c,r)),p=y.length,v=u[c]=new Array(p),d=a[c]=new Array(p),b=l[c]=new Array(h);n(s,f,v,d,b,y,e);for(var m,g,w=0,S=0;w<p;++w)if(m=v[w]){for(w>=S&&(S=w+1);!(g=d[S])&&++S<p;);m._next=g||null}}return(a=new vh(a,r))._enter=u,a._exit=l,a},enter:function(){return new vh(this._enter||this._groups.map(pf),this._parents)},exit:function(){return new vh(this._exit||this._groups.map(pf),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),u=new Array(i),l=0;l<a;++l)for(var c,s=n[l],f=r[l],h=s.length,y=u[l]=new Array(h),p=0;p<h;++p)(c=s[p]||f[p])&&(y[p]=c);for(;l<i;++l)u[l]=n[l];return new vh(u,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Sf);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,u=n[o],l=u.length,c=i[o]=new Array(l),s=0;s<l;++s)(a=u[s])&&(c[s]=a);c.sort(e)}return new vh(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=jf(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?xf:_f:"function"==typeof e?n.local?Tf:Af:n.local?Ef:Pf)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Mf:"function"==typeof e?Nf:Rf)(t,e,null==n?"":n)):If(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Df:"function"==typeof e?zf:$f)(t,e)):this.node()[t]},classed:function(t,e){var n=Bf(t+"");if(arguments.length<2){for(var r=Hf(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?Lf:e?Wf:Uf)(n,e))},text:function(t){return arguments.length?this.each(null==t?Xf:("function"==typeof t?Zf:Yf)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Kf:("function"==typeof t?Gf:Jf)(t)):this.node().innerHTML},raise:function(){return this.each(Qf)},lower:function(){return this.each(th)},append:function(t){var e="function"==typeof t?t:rh(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:rh(t),r=null==e?ih:"function"==typeof e?e:rf(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(oh)},clone:function(t){return this.select(t?uh:ah)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=lh(t+""),a=o.length;if(!(arguments.length<2)){for(u=e?sh:ch,r=0;r<a;++r)this.each(u(o[r],e,n));return this}var u=this.node().__on;if(u)for(var l,c=0,s=u.length;c<s;++c)for(r=0,l=u[c];r<a;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?yh:hh)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};var bh=dh,mh=function(t){return"string"==typeof t?new vh([[document.querySelector(t)]],[document.documentElement]):new vh([[t]],ph)};var gh=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function wh(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Sh(){}var Oh="\\s*([+-]?\\d+)\\s*",kh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",jh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_h=/^#([0-9a-f]{3,8})$/,xh=new RegExp(`^rgb\\(${Oh},${Oh},${Oh}\\)$`),Ph=new RegExp(`^rgb\\(${jh},${jh},${jh}\\)$`),Eh=new RegExp(`^rgba\\(${Oh},${Oh},${Oh},${kh}\\)$`),Ah=new RegExp(`^rgba\\(${jh},${jh},${jh},${kh}\\)$`),Th=new RegExp(`^hsl\\(${kh},${jh},${jh}\\)$`),Ch=new RegExp(`^hsla\\(${kh},${jh},${jh},${kh}\\)$`),Mh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Rh(){return this.rgb().formatHex()}function Nh(){return this.rgb().formatRgb()}function Ih(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=_h.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Dh(e):3===n?new Hh(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?$h(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?$h(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=xh.exec(t))?new Hh(e[1],e[2],e[3],1):(e=Ph.exec(t))?new Hh(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Eh.exec(t))?$h(e[1],e[2],e[3],e[4]):(e=Ah.exec(t))?$h(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Th.exec(t))?Lh(e[1],e[2]/100,e[3]/100,1):(e=Ch.exec(t))?Lh(e[1],e[2]/100,e[3]/100,e[4]):Mh.hasOwnProperty(t)?Dh(Mh[t]):"transparent"===t?new Hh(NaN,NaN,NaN,0):null}function Dh(t){return new Hh(t>>16&255,t>>8&255,255&t,1)}function $h(t,e,n,r){return r<=0&&(t=e=n=NaN),new Hh(t,e,n,r)}function zh(t){return t instanceof Sh||(t=Ih(t)),t?new Hh((t=t.rgb()).r,t.g,t.b,t.opacity):new Hh}function Bh(t,e,n,r){return 1===arguments.length?zh(t):new Hh(t,e,n,null==r?1:r)}function Hh(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Fh(){return`#${Uh(this.r)}${Uh(this.g)}${Uh(this.b)}`}function qh(){const t=Vh(this.opacity);return`${1===t?"rgb(":"rgba("}${Wh(this.r)}, ${Wh(this.g)}, ${Wh(this.b)}${1===t?")":`, ${t})`}`}function Vh(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Wh(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Uh(t){return((t=Wh(t))<16?"0":"")+t.toString(16)}function Lh(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Yh(t,e,n,r)}function Xh(t){if(t instanceof Yh)return new Yh(t.h,t.s,t.l,t.opacity);if(t instanceof Sh||(t=Ih(t)),!t)return new Yh;if(t instanceof Yh)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,u=o-i,l=(o+i)/2;return u?(a=e===o?(n-r)/u+6*(n<r):n===o?(r-e)/u+2:(e-n)/u+4,u/=l<.5?o+i:2-o-i,a*=60):u=l>0&&l<1?0:a,new Yh(a,u,l,t.opacity)}function Yh(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Zh(t){return(t=(t||0)%360)<0?t+360:t}function Kh(t){return Math.max(0,Math.min(1,t||0))}function Jh(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Gh(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}gh(Sh,Ih,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Rh,formatHex:Rh,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Xh(this).formatHsl()},formatRgb:Nh,toString:Nh}),gh(Hh,Bh,wh(Sh,{brighter(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Hh(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Hh(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Hh(Wh(this.r),Wh(this.g),Wh(this.b),Vh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Fh,formatHex:Fh,formatHex8:function(){return`#${Uh(this.r)}${Uh(this.g)}${Uh(this.b)}${Uh(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:qh,toString:qh})),gh(Yh,(function(t,e,n,r){return 1===arguments.length?Xh(t):new Yh(t,e,n,null==r?1:r)}),wh(Sh,{brighter(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Yh(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?.7:Math.pow(.7,t),new Yh(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Hh(Jh(t>=240?t-240:t+120,i,r),Jh(t,i,r),Jh(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Yh(Zh(this.h),Kh(this.s),Kh(this.l),Vh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Vh(this.opacity);return`${1===t?"hsl(":"hsla("}${Zh(this.h)}, ${100*Kh(this.s)}%, ${100*Kh(this.l)}%${1===t?")":`, ${t})`}`}}));var Qh=t=>()=>t;function ty(t,e){return function(n){return t+n*e}}function ey(t){return 1==(t=+t)?ny:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Qh(isNaN(e)?n:e)}}function ny(t,e){var n=e-t;return n?ty(t,n):Qh(isNaN(t)?e:t)}var ry=function t(e){var n=ey(e);function r(t,e){var r=n((t=Bh(t)).r,(e=Bh(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=ny(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function iy(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),u=new Array(i);for(n=0;n<i;++n)r=Bh(e[n]),o[n]=r.r||0,a[n]=r.g||0,u[n]=r.b||0;return o=t(o),a=t(a),u=t(u),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=u(t),r+""}}}iy((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,u=r<e-1?t[r+2]:2*o-i;return Gh((n-r/e)*e,a,i,o,u)}})),iy((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],u=t[(r+2)%e];return Gh((n-r/e)*e,i,o,a,u)}}));var oy=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}};function ay(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function uy(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=dy(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}var ly=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},cy=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},sy=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=dy(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},fy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hy=new RegExp(fy.source,"g");var yy,py,vy=function(t,e){var n,r,i,o=fy.lastIndex=hy.lastIndex=0,a=-1,u=[],l=[];for(t+="",e+="";(n=fy.exec(t))&&(r=hy.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),u[a]?u[a]+=i:u[++a]=i),(n=n[0])===(r=r[0])?u[a]?u[a]+=r:u[++a]=r:(u[++a]=null,l.push({i:a,x:cy(n,r)})),o=hy.lastIndex;return o<e.length&&(i=e.slice(o),u[a]?u[a]+=i:u[++a]=i),u.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)u[(n=l[r]).i]=n.x(t);return u.join("")})},dy=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Qh(e):("number"===r?cy:"string"===r?(n=Ih(e))?(e=n,ry):vy:e instanceof Ih?ry:e instanceof Date?ly:ay(e)?oy:Array.isArray(e)?uy:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?sy:cy)(t,e)},by=0,my=0,gy=0,wy=0,Sy=0,Oy=0,ky="object"==typeof performance&&performance.now?performance:Date,jy="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function _y(){return Sy||(jy(xy),Sy=ky.now()+Oy)}function xy(){Sy=0}function Py(){this._call=this._time=this._next=null}function Ey(t,e,n){var r=new Py;return r.restart(t,e,n),r}function Ay(){Sy=(wy=ky.now())+Oy,by=my=0;try{!function(){_y(),++by;for(var t,e=yy;e;)(t=Sy-e._time)>=0&&e._call.call(void 0,t),e=e._next;--by}()}finally{by=0,function(){var t,e,n=yy,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:yy=e);py=t,Cy(r)}(),Sy=0}}function Ty(){var t=ky.now(),e=t-wy;e>1e3&&(Oy-=e,wy=t)}function Cy(t){by||(my&&(my=clearTimeout(my)),t-Sy>24?(t<1/0&&(my=setTimeout(Ay,t-ky.now()-Oy)),gy&&(gy=clearInterval(gy))):(gy||(wy=ky.now(),gy=setInterval(Ty,1e3)),by=1,jy(Ay)))}Py.prototype=Ey.prototype={constructor:Py,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?_y():+n)+(null==e?0:+e),this._next||py===this||(py?py._next=this:yy=this,py=this),this._call=t,this._time=n,Cy()},stop:function(){this._call&&(this._call=null,this._time=1/0,Cy())}};var My=function(t,e,n){var r=new Py;return e=null==e?0:+e,r.restart(n=>{r.stop(),t(n+e)},e,n),r},Ry=ef("start","end","cancel","interrupt"),Ny=[],Iy=function(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(l){var c,s,f,h;if(1!==n.state)return u();for(c in i)if((h=i[c]).name===n.name){if(3===h.state)return My(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[c]):+c<e&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[c])}if(My((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(f=n.tween.length),c=0,s=-1;c<f;++c)(h=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(r[++s]=h);r.length=s+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(u),n.state=5,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Ey((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:Ry,tween:Ny,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})};function Dy(t,e){var n=zy(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function $y(t,e){var n=zy(t,e);if(n.state>3)throw new Error("too late; already running");return n}function zy(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var By,Hy=function(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}},Fy=180/Math.PI,qy={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Vy=function(t,e,n,r,i,o){var a,u,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,l/=u),t*r<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Fy,skewX:Math.atan(l)*Fy,scaleX:a,scaleY:u}};function Wy(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var u=[],l=[];return o=t(o),a=t(a),function(t,r,i,o,a,u){if(t!==i||r!==o){var l=a.push("translate(",null,e,null,n);u.push({i:l-4,x:cy(t,i)},{i:l-2,x:cy(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,u,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:cy(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,u,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:cy(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,u,l),function(t,e,n,r,o,a){if(t!==n||e!==r){var u=o.push(i(o)+"scale(",null,",",null,")");a.push({i:u-4,x:cy(t,n)},{i:u-2,x:cy(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,u,l),o=a=null,function(t){for(var e,n=-1,r=l.length;++n<r;)u[(e=l[n]).i]=e.x(t);return u.join("")}}}var Uy=Wy((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?qy:Vy(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Ly=Wy((function(t){return null==t?qy:(By||(By=document.createElementNS("http://www.w3.org/2000/svg","g")),By.setAttribute("transform",t),(t=By.transform.baseVal.consolidate())?(t=t.matrix,Vy(t.a,t.b,t.c,t.d,t.e,t.f)):qy)}),", ",")",")");function Xy(t,e){var n,r;return function(){var i=$y(this,t),o=i.tween;if(o!==n)for(var a=0,u=(r=n=o).length;a<u;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function Yy(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=$y(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var u={name:e,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=u;break}l===c&&i.push(u)}o.tween=i}}function Zy(t,e,n){var r=t._id;return t.each((function(){var t=$y(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return zy(t,r).value[e]}}var Ky=function(t,e){var n;return("number"==typeof e?cy:e instanceof Ih?ry:(n=Ih(e))?(e=n,ry):vy)(t,e)};function Jy(t){return function(){this.removeAttribute(t)}}function Gy(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qy(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function tp(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function ep(t,e,n){var r,i,o;return function(){var a,u,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(u=l+"")?null:a===r&&u===i?o:(i=u,o=e(r=a,l));this.removeAttribute(t)}}function np(t,e,n){var r,i,o;return function(){var a,u,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(u=l+"")?null:a===r&&u===i?o:(i=u,o=e(r=a,l));this.removeAttributeNS(t.space,t.local)}}function rp(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function ip(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function op(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&ip(t,i)),n}return i._value=e,i}function ap(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&rp(t,i)),n}return i._value=e,i}function up(t,e){return function(){Dy(this,t).delay=+e.apply(this,arguments)}}function lp(t,e){return e=+e,function(){Dy(this,t).delay=e}}function cp(t,e){return function(){$y(this,t).duration=+e.apply(this,arguments)}}function sp(t,e){return e=+e,function(){$y(this,t).duration=e}}function fp(t,e){if("function"!=typeof e)throw new Error;return function(){$y(this,t).ease=e}}function hp(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Dy:$y;return function(){var a=o(this,t),u=a.on;u!==r&&(i=(r=u).copy()).on(e,n),a.on=i}}var yp=bh.prototype.constructor;function pp(t){return function(){this.style.removeProperty(t)}}function vp(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function dp(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&vp(t,o,n)),r}return o._value=e,o}function bp(t){return function(e){this.textContent=t.call(this,e)}}function mp(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&bp(r)),e}return r._value=t,r}var gp=0;function wp(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Sp(){return++gp}var Op=bh.prototype;wp.prototype=function(t){return bh().transition(t)}.prototype={constructor:wp,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=rf(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var u,l,c=r[a],s=c.length,f=o[a]=new Array(s),h=0;h<s;++h)(u=c[h])&&(l=t.call(u,u.__data__,h,c))&&("__data__"in u&&(l.__data__=u.__data__),f[h]=l,Iy(f[h],e,n,h,f,zy(u,n)));return new wp(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=uf(t));for(var r=this._groups,i=r.length,o=[],a=[],u=0;u<i;++u)for(var l,c=r[u],s=c.length,f=0;f<s;++f)if(l=c[f]){for(var h,y=t.call(l,l.__data__,f,c),p=zy(l,n),v=0,d=y.length;v<d;++v)(h=y[v])&&Iy(h,e,n,v,y,p);o.push(y),a.push(l)}return new wp(o,a,e,n)},selectChild:Op.selectChild,selectChildren:Op.selectChildren,filter:function(t){"function"!=typeof t&&(t=lf(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],u=a.length,l=r[i]=[],c=0;c<u;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&l.push(o);return new wp(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var l,c=e[u],s=n[u],f=c.length,h=a[u]=new Array(f),y=0;y<f;++y)(l=c[y]||s[y])&&(h[y]=l);for(;u<r;++u)a[u]=e[u];return new wp(a,this._parents,this._name,this._id)},selection:function(){return new yp(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Sp(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],l=u.length,c=0;c<l;++c)if(a=u[c]){var s=zy(a,e);Iy(a,t,n,c,u,{time:s.time+s.delay+s.duration,delay:0,duration:s.duration,ease:s.ease})}return new wp(r,this._parents,t,n)},call:Op.call,nodes:Op.nodes,node:Op.node,size:Op.size,empty:Op.empty,each:Op.each,on:function(t,e){var n=this._id;return arguments.length<2?zy(this.node(),n).on.on(t):this.each(hp(n,t,e))},attr:function(t,e){var n=jf(t),r="transform"===n?Ly:Ky;return this.attrTween(t,"function"==typeof e?(n.local?np:ep)(n,r,Zy(this,"attr."+t,e)):null==e?(n.local?Gy:Jy)(n):(n.local?tp:Qy)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=jf(t);return this.tween(n,(r.local?op:ap)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Uy:Ky;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=If(this,t),a=(this.style.removeProperty(t),If(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,pp(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=If(this,t),u=n(this),l=u+"";return null==u&&(this.style.removeProperty(t),l=u=If(this,t)),a===l?null:a===r&&l===i?o:(i=l,o=e(r=a,u))}}(t,r,Zy(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,u="end."+a;return function(){var l=$y(this,t),c=l.on,s=null==l.value[a]?o||(o=pp(e)):void 0;c===n&&i===s||(r=(n=c).copy()).on(u,i=s),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=If(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,dp(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Zy(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,mp(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=zy(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?Xy:Yy)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?up:lp)(e,t)):zy(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?cp:sp)(e,t)):zy(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(fp(e,t)):zy(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;$y(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var u={value:a},l={value:function(){0==--i&&o()}};n.each((function(){var n=$y(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(u),e._.interrupt.push(u),e._.end.push(l)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:Op[Symbol.iterator]};var kp={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function jp(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}bh.prototype.interrupt=function(t){return this.each((function(){Hy(this,t)}))},bh.prototype.transition=function(t){var e,n;t instanceof wp?(e=t._id,t=t._name):(e=Sp(),(n=kp).time=_y(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],l=u.length,c=0;c<l;++c)(a=u[c])&&Iy(a,t,e,c,u,n||jp(a,e));return new wp(r,this._parents,t,e)};const{abs:_p,max:xp,min:Pp}=Math;function Ep(t){return[+t[0],+t[1]]}function Ap(t){return[Ep(t[0]),Ep(t[1])]}["w","e"].map(Tp),["n","s"].map(Tp),["n","w","e","s","nw","ne","sw","se"].map(Tp);function Tp(t){return{type:t}}function Cp(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}function Mp(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}class Rp extends Map{constructor(t,e=$p){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(Np(this,t))}has(t){return super.has(Np(this,t))}set(t,e){return super.set(Ip(this,t),e)}delete(t){return super.delete(Dp(this,t))}}Set;function Np({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Ip({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Dp({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function $p(t){return null!==t&&"object"==typeof t?t.valueOf():t}const zp=Symbol("implicit");function Bp(){var t=new Rp,e=[],n=[],r=zp;function i(i){let o=t.get(i);if(void 0===o){if(r!==zp)return r;t.set(i,o=e.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Rp;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Bp(e,n).unknown(r)},Mp.apply(i,arguments),i}function Hp(){var t,e,n=Bp().unknown(void 0),r=n.domain,i=n.range,o=0,a=1,u=!1,l=0,c=0,s=.5;function f(){var n=r().length,f=a<o,h=f?a:o,y=f?o:a;t=(y-h)/Math.max(1,n-l+2*c),u&&(t=Math.floor(t)),h+=(y-h-t*(n-l))*s,e=t*(1-l),u&&(h=Math.round(h),e=Math.round(e));var p=Cp(n).map((function(e){return h+t*e}));return i(f?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),f()):r()},n.range=function(t){return arguments.length?([o,a]=t,o=+o,a=+a,f()):[o,a]},n.rangeRound=function(t){return[o,a]=t,o=+o,a=+a,u=!0,f()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(u=!!t,f()):u},n.padding=function(t){return arguments.length?(l=Math.min(1,c=+t),f()):l},n.paddingInner=function(t){return arguments.length?(l=Math.min(1,t),f()):l},n.paddingOuter=function(t){return arguments.length?(c=+t,f()):c},n.align=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),f()):s},n.copy=function(){return Hp(r(),[o,a]).round(u).paddingInner(l).paddingOuter(c).align(s)},Mp.apply(f(),arguments)}function Fp(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Fp(e())},t}const qp=Math.sqrt(50),Vp=Math.sqrt(10),Wp=Math.sqrt(2);function Up(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=qp?10:o>=Vp?5:o>=Wp?2:1;let u,l,c;return i<0?(c=Math.pow(10,-i)/a,u=Math.round(t*c),l=Math.round(e*c),u/c<t&&++u,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*a,u=Math.round(t/c),l=Math.round(e/c),u*c<t&&++u,l*c>e&&--l),l<u&&.5<=n&&n<2?Up(t,e,2*n):[u,l,c]}function Lp(t,e,n){return Up(t=+t,e=+e,n=+n)[2]}function Xp(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Yp(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Zp(t){let e,n,r;function i(t,r,i=0,o=t.length){if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=Xp,n=(e,n)=>Xp(t(e),n),r=(e,n)=>t(e)-n):(e=t===Xp||t===Yp?t:Kp,n=t,r=t),{left:i,center:function(t,e,n=0,o=t.length){const a=i(t,e,n,o-1);return a>n&&r(t[a-1],e)>-r(t[a],e)?a-1:a},right:function(t,r,i=0,o=t.length){if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}function Kp(){return 0}const Jp=Zp(Xp),Gp=Jp.right;Jp.left,Zp((function(t){return null===t?NaN:+t})).center;var Qp=Gp,tv=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}};function ev(t){return+t}var nv=[0,1];function rv(t){return t}function iv(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function ov(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=iv(i,r),o=n(a,o)):(r=iv(r,i),o=n(o,a)),function(t){return o(r(t))}}function av(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=iv(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=Qp(t,e,1,r)-1;return o[n](i[n](e))}}function uv(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function lv(){var t,e,n,r,i,o,a=nv,u=nv,l=dy,c=rv;function s(){var t,e,n,l=Math.min(a.length,u.length);return c!==rv&&(t=a[0],e=a[l-1],t>e&&(n=t,t=e,e=n),c=function(n){return Math.max(t,Math.min(e,n))}),r=l>2?av:ov,i=o=null,f}function f(e){return null==e||isNaN(e=+e)?n:(i||(i=r(a.map(t),u,l)))(t(c(e)))}return f.invert=function(n){return c(e((o||(o=r(u,a.map(t),cy)))(n)))},f.domain=function(t){return arguments.length?(a=Array.from(t,ev),s()):a.slice()},f.range=function(t){return arguments.length?(u=Array.from(t),s()):u.slice()},f.rangeRound=function(t){return u=Array.from(t),l=tv,s()},f.clamp=function(t){return arguments.length?(c=!!t||rv,s()):c!==rv},f.interpolate=function(t){return arguments.length?(l=t,s()):l},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,s()}}function cv(){return lv()(rv,rv)}var sv=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function fv(t){if(!(e=sv.exec(t)))throw new Error("invalid format: "+t);var e;return new hv({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function hv(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}fv.prototype=hv.prototype,hv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};function yv(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}var pv,vv,dv,bv,mv=function(t){return(t=yv(Math.abs(t)))?t[1]:NaN},gv=function(t,e){var n=yv(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},wv={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>gv(100*t,e),r:gv,s:function(t,e){var n=yv(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(pv=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+yv(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)},Sv=function(t){return t},Ov=Array.prototype.map,kv=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];vv=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Sv:(e=Ov.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,u=e[0],l=0;i>0&&u>0&&(l+u+1>r&&(u=Math.max(1,r-l)),o.push(t.substring(i-=u,i+u)),!((l+=u+1)>r));)u=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?Sv:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Ov.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"":t.minus+"",s=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=fv(t)).fill,n=t.align,f=t.sign,h=t.symbol,y=t.zero,p=t.width,v=t.comma,d=t.precision,b=t.trim,m=t.type;"n"===m?(v=!0,m="g"):wv[m]||(void 0===d&&(d=12),b=!0,m="g"),(y||"0"===e&&"="===n)&&(y=!0,e="0",n="=");var g="$"===h?i:"#"===h&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",w="$"===h?o:/[%p]/.test(m)?l:"",S=wv[m],O=/[defgprs%]/.test(m);function k(t){var i,o,l,h=g,k=w;if("c"===m)k=S(t)+k,t="";else{var j=(t=+t)<0||1/t<0;if(t=isNaN(t)?s:S(Math.abs(t),d),b&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),j&&0==+t&&"+"!==f&&(j=!1),h=(j?"("===f?f:c:"-"===f||"("===f?"":f)+h,k=("s"===m?kv[8+pv/3]:"")+k+(j&&"("===f?")":""),O)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){k=(46===l?a+t.slice(i+1):t.slice(i))+k,t=t.slice(0,i);break}}v&&!y&&(t=r(t,1/0));var _=h.length+t.length+k.length,x=_<p?new Array(p-_+1).join(e):"";switch(v&&y&&(t=r(x+t,x.length?p-k.length:1/0),x=""),n){case"<":t=h+t+k+x;break;case"=":t=h+x+t+k;break;case"^":t=x.slice(0,_=x.length>>1)+h+t+k+x.slice(_);break;default:t=x+h+t+k}return u(t)}return d=void 0===d?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),k.toString=function(){return t+""},k}return{format:f,formatPrefix:function(t,e){var n=f(((t=fv(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(mv(e)/3))),i=Math.pow(10,-r),o=kv[8+r/3];return function(t){return n(i*t)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),dv=vv.format,bv=vv.formatPrefix;function jv(t,e,n,r){var i,o=function(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?Lp(e,t,n):Lp(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}(t,e,n);switch((r=fv(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(mv(e)/3)))-mv(Math.abs(t)))}(o,a))||(r.precision=i),bv(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,mv(e)-mv(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-mv(Math.abs(t)))}(o))||(r.precision=i-2*("%"===r.type))}return dv(r)}function _v(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[i,o,a]=r?Up(e,t,n):Up(t,e,n);if(!(o>=i))return[];const u=o-i+1,l=new Array(u);if(r)if(a<0)for(let t=0;t<u;++t)l[t]=(o-t)/-a;else for(let t=0;t<u;++t)l[t]=(o-t)*a;else if(a<0)for(let t=0;t<u;++t)l[t]=(i+t)/-a;else for(let t=0;t<u;++t)l[t]=(i+t)*a;return l}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return jv(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),a=0,u=o.length-1,l=o[a],c=o[u],s=10;for(c<l&&(i=l,l=c,c=i,i=a,a=u,u=i);s-- >0;){if((i=Lp(l,c,n))===r)return o[a]=l,o[u]=c,e(o);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i}r=i}return t},t}function xv(){var t=cv();return t.copy=function(){return uv(t,xv())},Mp.apply(t,arguments),_v(t)}var Pv=function(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Ev=function(t){return function(){return t}};const Av=Math.abs,Tv=Math.atan2,Cv=Math.cos,Mv=Math.max,Rv=Math.min,Nv=Math.sin,Iv=Math.sqrt,Dv=Math.PI,$v=Dv/2,zv=2*Dv;function Bv(t){return t>1?0:t<-1?Dv:Math.acos(t)}function Hv(t){return t>=1?$v:t<=-1?-$v:Math.asin(t)}const Fv=Math.PI,qv=2*Fv,Vv=qv-1e-6;function Wv(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class Uv{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?Wv:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error("invalid digits: "+t);if(e>15)return Wv;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,i,o){this._append`C${+t},${+e},${+n},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(t,e,n,r,i){if(t=+t,e=+e,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: "+i);let o=this._x1,a=this._y1,u=n-t,l=r-e,c=o-t,s=a-e,f=c*c+s*s;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(f>1e-6)if(Math.abs(s*u-l*c)>1e-6&&i){let h=n-o,y=r-a,p=u*u+l*l,v=h*h+y*y,d=Math.sqrt(p),b=Math.sqrt(f),m=i*Math.tan((Fv-Math.acos((p+f-v)/(2*d*b)))/2),g=m/b,w=m/d;Math.abs(g-1)>1e-6&&this._append`L${t+g*c},${e+g*s}`,this._append`A${i},${i},0,0,${+(s*h>c*y)},${this._x1=t+w*u},${this._y1=e+w*l}`}else this._append`L${this._x1=t},${this._y1=e}`;else;}arc(t,e,n,r,i,o){if(t=+t,e=+e,o=!!o,(n=+n)<0)throw new Error("negative radius: "+n);let a=n*Math.cos(r),u=n*Math.sin(r),l=t+a,c=e+u,s=1^o,f=o?r-i:i-r;null===this._x1?this._append`M${l},${c}`:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&this._append`L${l},${c}`,n&&(f<0&&(f=f%qv+qv),f>Vv?this._append`A${n},${n},0,1,${s},${t-a},${e-u}A${n},${n},0,1,${s},${this._x1=l},${this._y1=c}`:f>1e-6&&this._append`A${n},${n},0,${+(f>=Fv)},${s},${this._x1=t+n*Math.cos(i)},${this._y1=e+n*Math.sin(i)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function Lv(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError("invalid digits: "+n);e=t}return t},()=>new Uv(e)}function Xv(t){return t.innerRadius}function Yv(t){return t.outerRadius}function Zv(t){return t.startAngle}function Kv(t){return t.endAngle}function Jv(t){return t&&t.padAngle}function Gv(t,e,n,r,i,o,a,u){var l=n-t,c=r-e,s=a-i,f=u-o,h=f*l-s*c;if(!(h*h<1e-12))return[t+(h=(s*(e-o)-f*(t-i))/h)*l,e+h*c]}function Qv(t,e,n,r,i,o,a){var u=t-n,l=e-r,c=(a?o:-o)/Iv(u*u+l*l),s=c*l,f=-c*u,h=t+s,y=e+f,p=n+s,v=r+f,d=(h+p)/2,b=(y+v)/2,m=p-h,g=v-y,w=m*m+g*g,S=i-o,O=h*v-p*y,k=(g<0?-1:1)*Iv(Mv(0,S*S*w-O*O)),j=(O*g-m*k)/w,_=(-O*m-g*k)/w,x=(O*g+m*k)/w,P=(-O*m+g*k)/w,E=j-d,A=_-b,T=x-d,C=P-b;return E*E+A*A>T*T+C*C&&(j=x,_=P),{cx:j,cy:_,x01:-s,y01:-f,x11:j*(i/S-1),y11:_*(i/S-1)}}Array.prototype.slice;var td=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)};function ed(t){this._context=t}ed.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var nd=function(t){return new ed(t)};function rd(t){return t[0]}function id(t){return t[1]}var od=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},ad=function(t){return t};function ud(t){return t<0?-1:1}function ld(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),u=(o*i+a*r)/(r+i);return(ud(o)+ud(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(u))||0}function cd(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function sd(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,u=(o-r)/3;t._context.bezierCurveTo(r+u,i+u*e,o-u,a-u*n,o,a)}function fd(t){this._context=t}function hd(t){this._context=new yd(t)}function yd(t){this._context=t}function pd(t){return new fd(t)}fd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:sd(this,this._t0,cd(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,sd(this,cd(this,n=ld(this,t,e)),n);break;default:sd(this,this._t0,n=ld(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(hd.prototype=Object.create(fd.prototype)).point=function(t,e){fd.prototype.point.call(this,e,t)},yd.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}};function vd(t){return((t=Math.exp(t))+1/t)/2}(function t(e,n,r){function i(t,i){var o,a,u=t[0],l=t[1],c=t[2],s=i[0],f=i[1],h=i[2],y=s-u,p=f-l,v=y*y+p*p;if(v<1e-12)a=Math.log(h/c)/e,o=function(t){return[u+t*y,l+t*p,c*Math.exp(e*t*a)]};else{var d=Math.sqrt(v),b=(h*h-c*c+r*v)/(2*c*n*d),m=(h*h-c*c-r*v)/(2*h*n*d),g=Math.log(Math.sqrt(b*b+1)-b),w=Math.log(Math.sqrt(m*m+1)-m);a=(w-g)/e,o=function(t){var r,i=t*a,o=vd(g),s=c/(n*d)*(o*(r=e*i+g,((r=Math.exp(2*r))-1)/(r+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[u+s*y,l+s*p,c*o/vd(e*i+g)]}}return o.duration=1e3*a*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i})(Math.SQRT2,2,4);function dd(t,e,n){this.k=t,this.x=e,this.y=n}dd.prototype={constructor:dd,scale:function(t){return 1===t?this:new dd(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new dd(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new dd(1,0,0);dd.prototype;function bd(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return md(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?md(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function md(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function gd(t,e,n,r,i){var o=t.append("svg").attr("width",n).attr("height",r),a=Hp().domain(e.map((function(t){return t.label}))).range([i.left,n-i.right]).padding(.2),u=xv().domain([0,Bs(e,(function(t){return t.value}))]).nice().range([r-i.bottom,i.top]);o.append("g").attr("transform","translate(0,".concat(r-i.bottom,")")).call(Xs(a)).selectAll("text").attr("transform","rotate(-45)").style("text-anchor","end"),o.append("g").attr("transform","translate(".concat(i.left,",0)")).call(Ys(u)),o.selectAll("rect").data(e).enter().append("rect").attr("x",(function(t){return a(t.label)})).attr("y",(function(t){return u(t.value)})).attr("width",a.bandwidth()).attr("height",(function(t){return r-i.bottom-u(t.value)})).attr("fill","#69b3a2"),o.append("text").attr("x",n/2).attr("y",20).attr("text-anchor","middle").text("").style("font-weight","bold")}function wd(t,e,n,r){var i=t.append("svg").attr("width",n).attr("height",r),o=Math.min(n,r)/2-40,a=Bp(Pv),u=i.append("g").attr("transform","translate(".concat(n/2,",").concat(r/2+10,")")),l=function(){var t=ad,e=od,n=null,r=Ev(0),i=Ev(zv),o=Ev(0);function a(a){var u,l,c,s,f,h=(a=td(a)).length,y=0,p=new Array(h),v=new Array(h),d=+r.apply(this,arguments),b=Math.min(zv,Math.max(-zv,i.apply(this,arguments)-d)),m=Math.min(Math.abs(b)/h,o.apply(this,arguments)),g=m*(b<0?-1:1);for(u=0;u<h;++u)(f=v[p[u]=u]=+t(a[u],u,a))>0&&(y+=f);for(null!=e?p.sort((function(t,n){return e(v[t],v[n])})):null!=n&&p.sort((function(t,e){return n(a[t],a[e])})),u=0,c=y?(b-h*g)/y:0;u<h;++u,d=s)l=p[u],s=d+((f=v[l])>0?f*c:0)+g,v[l]={data:a[l],index:u,value:f,startAngle:d,endAngle:s,padAngle:m};return v}return a.value=function(e){return arguments.length?(t="function"==typeof e?e:Ev(+e),a):t},a.sortValues=function(t){return arguments.length?(e=t,n=null,a):e},a.sort=function(t){return arguments.length?(n=t,e=null,a):n},a.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:Ev(+t),a):r},a.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:Ev(+t),a):i},a.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:Ev(+t),a):o},a}().value((function(t){return t.value})),c=function(){var t=Xv,e=Yv,n=Ev(0),r=null,i=Zv,o=Kv,a=Jv,u=null,l=Lv(c);function c(){var c,s,f=+t.apply(this,arguments),h=+e.apply(this,arguments),y=i.apply(this,arguments)-$v,p=o.apply(this,arguments)-$v,v=Av(p-y),d=p>y;if(u||(u=c=l()),h<f&&(s=h,h=f,f=s),h>1e-12)if(v>zv-1e-12)u.moveTo(h*Cv(y),h*Nv(y)),u.arc(0,0,h,y,p,!d),f>1e-12&&(u.moveTo(f*Cv(p),f*Nv(p)),u.arc(0,0,f,p,y,d));else{var b,m,g=y,w=p,S=y,O=p,k=v,j=v,_=a.apply(this,arguments)/2,x=_>1e-12&&(r?+r.apply(this,arguments):Iv(f*f+h*h)),P=Rv(Av(h-f)/2,+n.apply(this,arguments)),E=P,A=P;if(x>1e-12){var T=Hv(x/f*Nv(_)),C=Hv(x/h*Nv(_));(k-=2*T)>1e-12?(S+=T*=d?1:-1,O-=T):(k=0,S=O=(y+p)/2),(j-=2*C)>1e-12?(g+=C*=d?1:-1,w-=C):(j=0,g=w=(y+p)/2)}var M=h*Cv(g),R=h*Nv(g),N=f*Cv(O),I=f*Nv(O);if(P>1e-12){var D,$=h*Cv(w),z=h*Nv(w),B=f*Cv(S),H=f*Nv(S);if(v<Dv)if(D=Gv(M,R,B,H,$,z,N,I)){var F=M-D[0],q=R-D[1],V=$-D[0],W=z-D[1],U=1/Nv(Bv((F*V+q*W)/(Iv(F*F+q*q)*Iv(V*V+W*W)))/2),L=Iv(D[0]*D[0]+D[1]*D[1]);E=Rv(P,(f-L)/(U-1)),A=Rv(P,(h-L)/(U+1))}else E=A=0}j>1e-12?A>1e-12?(b=Qv(B,H,M,R,h,A,d),m=Qv($,z,N,I,h,A,d),u.moveTo(b.cx+b.x01,b.cy+b.y01),A<P?u.arc(b.cx,b.cy,A,Tv(b.y01,b.x01),Tv(m.y01,m.x01),!d):(u.arc(b.cx,b.cy,A,Tv(b.y01,b.x01),Tv(b.y11,b.x11),!d),u.arc(0,0,h,Tv(b.cy+b.y11,b.cx+b.x11),Tv(m.cy+m.y11,m.cx+m.x11),!d),u.arc(m.cx,m.cy,A,Tv(m.y11,m.x11),Tv(m.y01,m.x01),!d))):(u.moveTo(M,R),u.arc(0,0,h,g,w,!d)):u.moveTo(M,R),f>1e-12&&k>1e-12?E>1e-12?(b=Qv(N,I,$,z,f,-E,d),m=Qv(M,R,B,H,f,-E,d),u.lineTo(b.cx+b.x01,b.cy+b.y01),E<P?u.arc(b.cx,b.cy,E,Tv(b.y01,b.x01),Tv(m.y01,m.x01),!d):(u.arc(b.cx,b.cy,E,Tv(b.y01,b.x01),Tv(b.y11,b.x11),!d),u.arc(0,0,f,Tv(b.cy+b.y11,b.cx+b.x11),Tv(m.cy+m.y11,m.cx+m.x11),d),u.arc(m.cx,m.cy,E,Tv(m.y11,m.x11),Tv(m.y01,m.x01),!d))):u.arc(0,0,f,O,S,d):u.lineTo(N,I)}else u.moveTo(0,0);if(u.closePath(),c)return u=null,c+""||null}return c.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Dv/2;return[Cv(r)*n,Nv(r)*n]},c.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:Ev(+e),c):t},c.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Ev(+t),c):e},c.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:Ev(+t),c):n},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:Ev(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:Ev(+t),c):i},c.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:Ev(+t),c):o},c.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:Ev(+t),c):a},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c}().innerRadius(0).outerRadius(o),s=u.selectAll(".arc").data(l(e)).enter().append("g");s.append("path").attr("d",c).attr("fill",(function(t,e){return a(e)})).attr("stroke","#fff"),s.filter((function(t){return t.endAngle-t.startAngle>.2})).append("text").attr("transform",(function(t){return"translate(".concat(c.centroid(t),")")})).attr("text-anchor","middle").text((function(t){return t.data.label})).style("font-size","10px").style("fill","#fff"),i.append("text").attr("x",n/2).attr("y",20).attr("text-anchor","middle").text("").style("font-weight","bold")}function Sd(t,e,n,r,i){var o=t.append("svg").attr("width",n).attr("height",r),a=function(){return Fp(Hp.apply(null,arguments).paddingInner(1))}().domain(e.map((function(t){return t.label}))).range([i.left,n-i.right]),u=xv().domain([0,Bs(e,(function(t){return t.value}))]).nice().range([r-i.bottom,i.top]);o.append("g").attr("transform","translate(0,".concat(r-i.bottom,")")).call(Xs(a)),o.append("g").attr("transform","translate(".concat(i.left,",0)")).call(Ys(u));var l=function(t,e){var n=Ev(!0),r=null,i=nd,o=null,a=Lv(u);function u(u){var l,c,s,f=(u=td(u)).length,h=!1;for(null==r&&(o=i(s=a())),l=0;l<=f;++l)!(l<f&&n(c=u[l],l,u))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(c,l,u),+e(c,l,u));if(s)return o=null,s+""||null}return t="function"==typeof t?t:void 0===t?rd:Ev(t),e="function"==typeof e?e:void 0===e?id:Ev(e),u.x=function(e){return arguments.length?(t="function"==typeof e?e:Ev(+e),u):t},u.y=function(t){return arguments.length?(e="function"==typeof t?t:Ev(+t),u):e},u.defined=function(t){return arguments.length?(n="function"==typeof t?t:Ev(!!t),u):n},u.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),u):i},u.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),u):r},u}().x((function(t){return a(t.label)})).y((function(t){return u(t.value)})).curve(pd);o.append("path").datum(e).attr("fill","none").attr("stroke","#4e79a7").attr("stroke-width",2).attr("d",l),o.selectAll("circle").data(e).enter().append("circle").attr("cx",(function(t){return a(t.label)})).attr("cy",(function(t){return u(t.value)})).attr("r",4).attr("fill","#4e79a7"),o.append("text").attr("x",n/2).attr("y",20).attr("text-anchor","middle").text("").style("font-weight","bold")}function Od(t){return(Od="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,jd(r.key),r)}}function jd(t){var e=function(t,e){if("object"!=Od(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=Od(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Od(e)?e:e+""}function _d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return xd(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xd(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Pd(t,e){var n,r=this;return function(){for(var i=r,o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];var l=a;n||(n=setTimeout((function(){n=null,t.apply(i,l)}),e))}}function Ed(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t.getSelectedRect(),i=r.l,o=r.t,a=r.left,u=r.top,l=r.width,c=r.height,s=this.getTableOffset();if(Math.abs(a)+l>s.width)n.move({left:i+l-s.width});else{var f=t.freezeTotalWidth();a<f&&n.move({left:i-1-f})}if(Math.abs(u)+c>s.height)e.move({top:o+c-s.height-1});else{var h=t.freezeTotalHeight();u<h&&e.move({top:o-1-h})}}function Ad(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==n){var o=this.table,a=this.selector,u=this.toolbar,l=this.data,c=this.contextMenu,s=l.getCell(e,n);t?(a.setEnd(e,n,i),this.trigger("cells-selected",s,a.range)):(a.set(e,n,r),this.trigger("cell-selected",s,e,n)),c.setMode(-1===e||-1===n?"row-col":"range"),u.reset(),o.render()}}function Td(t,e){var n=this.selector,r=this.data,i=r.rows,o=r.cols,a=_d(n.indexes,2),u=a[0],l=a[1],c=n.range,s=c.eri,f=c.eci;if(t){var h=_d(n.moveIndexes,2);u=h[0],l=h[1]}"left"===e?l>0&&(l-=1):"right"===e?(f!==l&&(l=f),l<o.len-1&&(l+=1)):"up"===e?u>0&&(u-=1):"down"===e?(s!==u&&(u=s),u<i.len-1&&(u+=1)):"row-first"===e?l=0:"row-last"===e?l=o.len-1:"col-first"===e?u=0:"col-last"===e&&(u=i.len-1),t&&(n.moveIndexes=[u,l]),Ad.call(this,t,u,l),Ed.call(this)}function Cd(t){if(0===t.buttons&&t.target.className!=="".concat(ye,"-resizer-hover")){var e=t.offsetX,n=t.offsetY,r=this.rowResizer,i=this.colResizer,o=this.tableEl,a=this.data,u=a.rows,l=a.cols;if(e>l.indexWidth&&n>u.height)return r.hide(),void i.hide();var c=o.box(),s=a.getCellRectByXY(t.offsetX,t.offsetY);s.ri>=0&&-1===s.ci?(s.width=l.indexWidth,r.show(s,{width:c.width}),u.isHide(s.ri-1)?r.showUnhide(s.ri):r.hideUnhide()):r.hide(),-1===s.ri&&s.ci>=0?(s.height=u.height,i.show(s,{height:c.height}),l.isHide(s.ci-1)?i.showUnhide(s.ci):i.hideUnhide()):i.hide()}}function Md(t){var e=this.verticalScrollbar,n=this.horizontalScrollbar,r=this.data,i=e.scroll().top,o=n.scroll().left,a=r.rows,u=r.cols,l=t.deltaY,c=t.deltaX,s=function(t,e){var n=t,r=0;do{r=e(n),n+=1}while(r<=0);return r},f=function(t){if(t>0){var n=r.scroll.ri+1;if(n<a.len){var o=s(n,(function(t){return a.getHeight(t)}));e.move({top:i+o-1})}}else{var u=r.scroll.ri-1;if(u>=0){var l=s(u,(function(t){return a.getHeight(t)}));e.move({top:0===u?0:i-l})}}},h=Math.abs(l),y=Math.abs(c),p=Math.max(h,y);/Firefox/i.test(window.navigator.userAgent)&&Pd(f(t.detail),50),p===y&&Pd(function(t){if(t>0){var e=r.scroll.ci+1;if(e<u.len){var i=s(e,(function(t){return u.getWidth(t)}));n.move({left:o+i-1})}}else{var a=r.scroll.ci-1;if(a>=0){var l=s(a,(function(t){return u.getWidth(t)}));n.move({left:0===a?0:o-l})}}}(c),50),p===h&&Pd(f(l),50)}function Rd(t,e){var n=this.verticalScrollbar,r=this.horizontalScrollbar,i=n.scroll().top,o=r.scroll().left;"left"===t||"right"===t?r.move({left:o-e}):"up"!==t&&"down"!==t||n.move({top:i-e})}function Nd(){var t=this.data,e=this.verticalScrollbar,n=this.getTableOffset().height,r=t.exceptRowTotalHeight(0,-1);e.set(n,t.rows.totalHeight()-r)}function Id(){var t=this.data,e=this.horizontalScrollbar,n=this.getTableOffset().width;t&&e.set(n,t.cols.totalWidth())}function Dd(){var t=this.selector,e=this.data,n=this.editor,r=_d(e.freeze,2),i=r[0],o=r[1];if(i>0||o>0){var a=e.freezeTotalWidth(),u=e.freezeTotalHeight();n.setFreezeLengths(a,u)}t.resetAreaOffset()}function $d(){var t=this.tableEl,e=this.overlayerEl,n=this.overlayerCEl,r=this.table,i=this.toolbar,o=this.selector,a=this.el,u=this.getTableOffset(),l=this.getRect();t.attr(l),e.offset(l),n.offset(u),a.css("width","".concat(l.width,"px")),Nd.call(this),Id.call(this),Dd.call(this),r.render(),i.reset(),o.reset()}function zd(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function Bd(t){var e=this.data,n=this.selector;"read"!==e.settings.mode&&(e.copy(),e.copyToSystemClipboard(t),n.showClipboard())}function Hd(){var t=this.data,e=this.selector;"read"!==t.settings.mode&&(t.cut(),e.showClipboard())}function Fd(t,e){var n=this,r=this.data;if("read"!==r.settings.mode)if(r.clipboard.isClear()){r.pasteFromSystemClipboard((function(){return $d.call(n)}),(function(t){n.trigger("pasted-clipboard",t)}))}else if(r.paste(t,(function(t){return zs("Tip",t)})))$d.call(this);else if(e){var i=e.clipboardData.getData("text/plain");this.data.pasteFromText(i),$d.call(this)}}function qd(){this.data.hideRowsOrCols(),$d.call(this)}function Vd(t,e){this.data.unhideRowsOrCols(t,e),$d.call(this)}function Wd(){this.data.autofilter(),$d.call(this)}function Ud(){var t=this.toolbar;t.paintformatActive()&&(Fd.call(this,"format"),zd.call(this),t.paintformatToggle())}function Ld(t){var e=this,n=this.selector,r=this.data,i=this.table,o=this.sortFilter,a=t.offsetX,u=t.offsetY,l=t.target.className==="".concat(ye,"-selector-corner"),c=r.getCellRectByXY(a,u),s=c.left,f=c.top,h=c.width,y=c.height,p=c.ri,v=c.ci,d=r.autoFilter;if(d.includes(p,v)&&s+h-20<a&&f+y-20<u){var b=d.items(v,(function(t,e){return r.rows.getCell(t,e)}));return o.hide(),o.set(v,b,d.getFilter(v),d.getSort(v)),void o.setOffset({left:s,top:f+y+2})}t.shiftKey||(l?n.showAutofill(p,v):Ad.call(this,!1,p,v),se(window,(function(t){var i=r.getCellRectByXY(t.offsetX,t.offsetY);p=i.ri,v=i.ci,l?n.showAutofill(p,v):1!==t.buttons||t.shiftKey||Ad.call(e,!0,p,v,!0,!0)}),(function(){l&&n.arange&&"read"!==r.settings.mode&&r.autofill(n.arange,"all",(function(t){return zs("Tip",t)}))&&i.render(),n.hideAutofill(),Ud.call(e)}))),l||1!==t.buttons||t.shiftKey&&Ad.call(this,!0,p,v)}function Xd(){var t=this.editor,e=this.data.getSelectedRect(),n=this.getTableOffset(),r="top";e.top>n.height/2&&(r="bottom"),t.setOffset(e,r)}function Yd(){var t=this.editor,e=this.data;"read"!==e.settings.mode&&(Xd.call(this),t.setCell(e.getSelectedCell(),e.getSelectedValidator()),zd.call(this))}function Zd(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrolly(t,(function(){i.resetBRLAreaOffset(),Xd.call(e),r.render()}))}function Kd(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrollx(t,(function(){i.resetBRTAreaOffset(),Xd.call(e),r.render()}))}function Jd(t,e){var n=t.ri,r=this.table,i=this.selector,o=this.data,a=i.range,u=a.sri,l=a.eri;if(n>=u&&n<=l)for(var c=u;c<=l;c+=1)o.rows.setHeight(c,e);else o.rows.setHeight(n,e);r.render(),i.resetAreaOffset(),Nd.call(this),Xd.call(this)}function Gd(t,e){var n=t.ci,r=this.table,i=this.selector,o=this.data,a=i.range,u=a.sci,l=a.eci;if(n>=u&&n<=l)for(var c=u;c<=l;c+=1)o.cols.setWidth(c,e);else o.cols.setWidth(n,e);r.render(),i.resetAreaOffset(),Id.call(this),Xd.call(this)}function Qd(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",n=this.data,r=this.table;if("read"!==n.settings.mode){n.setSelectedCellText(t,e);var i=n.selector,o=i.ri,a=i.ci;"finished"===e?r.render():this.trigger("cell-edited",t,o,a)}}function tb(t){var e=this.data;"read"!==e.settings.mode&&("insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),zd.call(this),$d.call(this))}function eb(t,e){var n=this.data;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview();else if("paintformat"===t)!0===e?Bd.call(this):zd.call(this);else if("clearformat"===t)tb.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)Wd.call(this);else if("freeze"===t)if(e){var r=n.selector,i=r.ri,o=r.ci;this.freeze(i,o)}else this.freeze(0,0);else n.setSelectedCellAttr(t,e),"formula"!==t||n.selector.multiple()||Yd.call(this),$d.call(this)}function nb(t,e,n,r){this.data.setAutoFilter(t,e,n,r),$d.call(this)}function rb(){var t,e,n,r,i,o,a=this,u=this.selector,l=this.overlayerEl,c=this.rowResizer,s=this.colResizer,f=this.verticalScrollbar,h=this.horizontalScrollbar,y=this.editor,p=this.contextMenu,v=this.toolbar,d=this.modalValidation,b=this.sortFilter;l.on("mousemove",(function(t){Cd.call(a,t)})).on("mousedown",(function(t){y.clear(),p.hide(),2===t.buttons?(a.data.xyInSelectedRect(t.offsetX,t.offsetY)||Ld.call(a,t),p.setPosition(t.offsetX,t.offsetY),t.stopPropagation()):2===t.detail?Yd.call(a):Ld.call(a,t)})).on("mousewheel.stop",(function(t){Md.call(a,t)})).on("mouseout",(function(t){var e=t.offsetX;t.offsetY<=0&&s.hide(),e<=0&&c.hide()})),u.inputChange=function(t){Qd.call(a,t,"input"),Yd.call(a)},t=l.el,n=(e={move:function(t,e){Rd.call(a,t,e)}}).move,r=e.end,i=0,o=0,ae(t,"touchstart",(function(t){var e=t.touches[0],n=e.pageX,r=e.pageY;i=n,o=r})),ae(t,"touchmove",(function(t){if(n){var e=t.changedTouches[0],r=e.pageX,a=e.pageY,u=r-i,l=a-o;(Math.abs(u)>10||Math.abs(l)>10)&&(fe(u,l,t,n),i=r,o=a),t.preventDefault()}})),ae(t,"touchend",(function(t){if(r){var e=t.changedTouches[0],n=e.pageX,a=e.pageY;fe(n-i,a-o,t,r)}})),v.change=function(t,e){return eb.call(a,t,e)},b.ok=function(t,e,n,r){return nb.call(a,t,e,n,r)},c.finishedFn=function(t,e){Jd.call(a,t,e)},s.finishedFn=function(t,e){Gd.call(a,t,e)},c.unhideFn=function(t){Vd.call(a,"row",t)},s.unhideFn=function(t){Vd.call(a,"col",t)},f.moveFn=function(t,e){Zd.call(a,t,e)},h.moveFn=function(t,e){Kd.call(a,t,e)},y.change=function(t,e){Qd.call(a,e,t)},d.change=function(t){if("save"===t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=a.data).addValidation.apply(e,r)}else a.data.removeValidation()},p.itemClick=function(t){if("validation"===t)d.setValue(a.data.getSelectedValidation());else if("copy"===t)Bd.call(a);else if("cut"===t)Hd.call(a);else if("paste"===t)Fd.call(a,"all");else if("paste-value"===t)Fd.call(a,"text");else if("paste-format"===t)Fd.call(a,"format");else if("hide"===t)qd.call(a);else if("insert-row"===t||"insert-column"===t)tb.call(a,t);else if("vis"===t){!function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#visualization-container";if(t&&0!==t.length){var n="string"==typeof e?document.querySelector(e):e;if(n){var r=t.flat(),i={};r.forEach((function(t){var e=String(t);i[e]=(i[e]||0)+1}));var o=Object.entries(i).map((function(t){var e=bd(t,2);return{label:e[0],value:e[1]}}));if(0!==o.length){n.innerHTML="",n.style.display="flex",n.style.flexWrap="wrap",n.style.gap="20px",n.style.justifyContent="space-around";var a=350,u=300,l={top:30,right:20,bottom:60,left:50},c=["bar","pie","line"],s=c.map((function(t){var e=document.createElement("div");return e.className="chart-item chart-".concat(t),n.appendChild(e),mh(e)}));gd(s[0],o,a,u,l),wd(s[1],o,a,u),Sd(s[2],o,a,u,l)}else n.innerHTML="<p></p>"}}else console.warn("visualizeData: ")}(function(t){try{var e=t.data,n=t.selector;if(!e||!n)return console.error("getSelectedData: sheet "),[];var r=n.range;if(!r)return console.error("getSelectedData: "),[];for(var i=r.sri,o=r.sci,a=r.eri,u=r.eci,l=[],c=i;c<=a;c++){for(var s=[],f=o;f<=u;f++){var h=e.getCell(c,f);h?s.push(h.text||h.value||""):s.push("")}l.push(s)}return console.log("",l),l}catch(t){return console.error("get_data.js ",t),[]}}(a))}},ae(window,"resize",(function(){a.reload()})),ae(window,"click",(function(t){a.focusing=l.contains(t.target)})),ae(window,"paste",(function(t){a.focusing&&(Fd.call(a,"all",t),t.preventDefault())})),ae(window,"copy",(function(t){a.focusing&&(Bd.call(a,t),t.preventDefault())})),ae(window,"keydown",(function(t){if(a.focusing){var e=t.keyCode||t.which,n=t.key,r=t.ctrlKey,i=t.shiftKey,o=t.metaKey;if(r||o)switch(e){case 90:a.undo(),t.preventDefault();break;case 89:a.redo(),t.preventDefault();break;case 67:break;case 88:Hd.call(a),t.preventDefault();break;case 85:v.trigger("underline"),t.preventDefault();break;case 86:break;case 37:Td.call(a,i,"row-first"),t.preventDefault();break;case 38:Td.call(a,i,"col-first"),t.preventDefault();break;case 39:Td.call(a,i,"row-last"),t.preventDefault();break;case 40:Td.call(a,i,"col-last"),t.preventDefault();break;case 32:Ad.call(a,!1,-1,a.data.selector.ci,!1),t.preventDefault();break;case 66:v.trigger("bold");break;case 73:v.trigger("italic")}else{switch(e){case 32:i&&Ad.call(a,!1,a.data.selector.ri,-1,!1);break;case 27:p.hide(),zd.call(a);break;case 37:Td.call(a,i,"left"),t.preventDefault();break;case 38:Td.call(a,i,"up"),t.preventDefault();break;case 39:Td.call(a,i,"right"),t.preventDefault();break;case 40:Td.call(a,i,"down"),t.preventDefault();break;case 9:y.clear(),Td.call(a,!1,i?"left":"right"),t.preventDefault();break;case 13:y.clear(),Td.call(a,!1,i?"up":"down"),t.preventDefault();break;case 8:tb.call(a,"delete-cell-text"),t.preventDefault()}"Delete"===n?(tb.call(a,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(Qd.call(a,t.key,"input"),Yd.call(a)):113===e&&Yd.call(a)}}}))}var ib=function(){return t=function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventMap=he();var i=n.settings,o=i.view,a=i.showToolbar,u=i.showContextmenu;this.el=s("div","".concat(ye,"-sheet")),this.toolbar=new es(n,o.width,!a),this.print=new oi(n),e.children(this.toolbar.el,this.el,this.print.el),this.data=n,this.tableEl=s("canvas","".concat(ye,"-table")),this.rowResizer=new me(!1,n.rows.height),this.colResizer=new me(!0,n.cols.minWidth),this.verticalScrollbar=new Oe(!0),this.horizontalScrollbar=new Oe(!1),this.editor=new Nn(wr,(function(){return r.getTableOffset()}),n.rows.height),this.modalValidation=new As,this.contextMenu=new vi((function(){return r.getRect()}),!u),this.selector=new Ve(n),this.overlayerCEl=s("div","".concat(ye,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=s("div","".concat(ye,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new $s,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new Xr(this.tableEl.el,n),rb.call(this),$d.call(this),Ad.call(this,!1,0,0)},(e=[{key:"on",value:function(t,e){return this.eventMap.on(t,e),this}},{key:"trigger",value:function(t){for(var e=this.eventMap,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];e.fire(t,r)}},{key:"resetData",value:function(t){this.editor.clear(),this.data=t,Nd.call(this),Id.call(this),this.toolbar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t)}},{key:"loadData",value:function(t){return this.data.setData(t),$d.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),$d.call(this),this}},{key:"undo",value:function(){this.data.undo(),$d.call(this)}},{key:"redo",value:function(){this.data.redo(),$d.call(this)}},{key:"reload",value:function(){return $d.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,n=t.cols,r=this.getRect(),i=r.width,o=r.height;return{width:i-n.indexWidth,height:o-e.height,left:n.indexWidth,top:e.height}}}])&&kd(t.prototype,e),n&&kd(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function ob(t){return(ob="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ab(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||lb(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ub(t){return function(t){if(Array.isArray(t))return cb(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||lb(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lb(t,e){if(t){if("string"==typeof t)return cb(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cb(t,e):void 0}}function cb(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function sb(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yb(r.key),r)}}function hb(t,e,n){return e&&fb(t.prototype,e),n&&fb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function yb(t){var e=function(t,e){if("object"!=ob(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ob(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ob(e)?e:e+""}function pb(t,e,n){return e=vb(e),function(t,e){if(e&&("object"==ob(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],vb(t).constructor):e.apply(t,n))}function vb(t){return(vb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function db(t,e){return(db=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var bb=function(t){function e(t){var n;return sb(this,e),(n=pb(this,e,[new ln("ellipsis"),"auto",!1,"top-left"])).contentClick=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&db(t,e)}(e,t),hb(e,[{key:"reset",value:function(t){var e=this,n=t.map((function(t,n){return s("div","".concat(ye,"-item")).css("width","150px").css("font-weight","normal").on("click",(function(){e.contentClick(n),e.hide()})).child(t)}));this.setContentChildren.apply(this,ub(n))}},{key:"setTitle",value:function(){}}])}($i),mb=[{key:"delete",title:Ot("contextmenu.deleteSheet")}];function gb(t){var e=this;return s("div","".concat(ye,"-item")).child(t.title()).on("click",(function(){e.itemClick(t.key),e.hide()}))}function wb(){var t=this;return mb.map((function(e){return gb.call(t,e)}))}var Sb=function(){return hb((function t(){var e;sb(this,t),this.el=(e=s("div","".concat(ye,"-contextmenu")).css("width","160px")).children.apply(e,ub(wb.call(this))).hide(),this.itemClick=function(){}}),[{key:"hide",value:function(){var t=this.el;t.hide(),le(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),ce(e)}}])}(),Ob=function(){return hb((function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};sb(this,t),this.swapFunc=r,this.updateFunc=o,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new bb((function(t){e.clickSwap2(e.items[t])})),this.contextMenu=new Sb,this.contextMenu.itemClick=i,this.el=s("div","".concat(ye,"-bottombar")).children(this.contextMenu.el,this.menuEl=s("ul","".concat(ye,"-menu")).child(s("li","").children(new ln("add").on("click",(function(){n()})),s("span","").child(this.moreEl))))}),[{key:"addItem",value:function(t,e,n){var r=this;this.dataNames.push(t);var i=s("li",e?"active":"").child(t);i.on("click",(function(){r.clickSwap2(i)})).on("contextmenu",(function(t){if("read"!==n.mode){var e=t.target,o=e.offsetLeft,a=e.offsetHeight;r.contextMenu.setOffset({left:o,bottom:a+1}),r.deleteEl=i}})).on("dblclick",(function(){if("read"!==n.mode){var t=i.html(),e=new hs("auto","");e.val(t),e.input.on("blur",(function(e){var n=e.target.value,i=r.dataNames.findIndex((function(e){return e===t}));r.renameItem(i,n)})),i.html("").child(e.el),e.focus()}})),e&&this.clickSwap(i),this.items.push(i),this.menuEl.child(i),this.moreEl.reset(this.dataNames)}},{key:"renameItem",value:function(t,e){this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)}},{key:"clear",value:function(){var t=this;this.items.forEach((function(e){t.menuEl.removeChild(e.el)})),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var n=this.items.findIndex((function(t){return t===e}));if(this.items.splice(n,1),this.dataNames.splice(n,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var r=ab(this.items,1)[0];return this.activeEl=r,this.activeEl.toggle(),[n,0]}return[n,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex((function(e){return e===t}));this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}}])}();n(177);function kb(t){return(kb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jb(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);l=!0);}catch(t){c=!0,i=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return _b(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_b(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _b(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function xb(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Pb(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?xb(Object(n),!0).forEach((function(e){Eb(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xb(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Eb(t,e,n){return(e=Cb(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ab(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tb(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cb(r.key),r)}}function Cb(t){var e=function(t,e){if("object"!=kb(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=kb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==kb(e)?e:e+""}var Mb=function(){return t=function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ab(this,t);var i=e;this.options=Pb({showBottomBar:!0},r),this.sheetIndex=1,this.datas=[],"string"==typeof e&&(i=document.querySelector(e)),this.bottombar=this.options.showBottomBar?new Ob((function(){if("read"!==n.options.mode){var t=n.addSheet();n.sheet.resetData(t)}}),(function(t){var e=n.datas[t];n.sheet.resetData(e)}),(function(){n.deleteSheet()}),(function(t,e){n.datas[t].name=e,n.sheet.trigger("change")})):null,this.data=this.addSheet();var o=s("div","".concat(ye)).on("contextmenu",(function(t){return t.preventDefault()}));i.appendChild(o.el),this.sheet=new ib(o,this.data),null!==this.bottombar&&o.child(this.bottombar.el)},n=[{key:"locale",value:function(t,e){kt(t,e)}}],(e=[{key:"addSheet",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=t||"sheet".concat(this.sheetIndex),i=new ne(r,this.options);return i.change=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.sheet).trigger.apply(t,["change"].concat(r))},this.datas.push(i),null!==this.bottombar&&this.bottombar.addItem(r,n,this.options),this.sheetIndex+=1,i}},{key:"deleteSheet",value:function(){if(null!==this.bottombar){var t=jb(this.bottombar.deleteItem(),2),e=t[0],n=t[1];e>=0&&(this.datas.splice(e,1),n>=0&&this.sheet.resetData(this.datas[n]),this.sheet.trigger("change"))}}},{key:"loadData",value:function(t){var e=Array.isArray(t)?t:[t];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],e.length>0)for(var n=0;n<e.length;n+=1){var r=e[n],i=this.addSheet(r.name,0===n);i.setData(r),0===n&&this.sheet.resetData(i)}return this}},{key:"getData",value:function(){return this.datas.map((function(t){return t.getData()}))}},{key:"cellText",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[r].setCellText(t,e,n,"finished"),this}},{key:"cell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}}])&&Tb(t.prototype,e),n&&Tb(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}(),Rb=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Mb(t,e)};window&&(window.x_spreadsheet=Rb,window.x_spreadsheet.locale=function(t,e){return kt(t,e)});e.default=Mb},54:function(t,e){}});
//# sourceMappingURL=xspreadsheet.js.map